(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{o0HM:function(t,e,i){"use strict";i.r(e),i.d(e,"SitesModule",(function(){return qt}));var n=i("ofXK"),s=i("sYmb"),o=i("tyNb"),r=i("3Pt+"),a=i("+0xr"),c=i("D//C"),l=i("XOCf"),h=i("quSY"),d=i("fXoL"),p=i("c3AT"),_=i("NFeN"),m=i("kmnG"),u=i("qFsG"),g=i("iadO"),b=i("bTqV"),f=i("d3UM"),v=i("A5z7"),D=i("FKr1");function S(t,e){1&t&&d.Ob(0,"th",23)}function w(t,e){1&t&&(d.Tb(0,"td",24),d.Tb(1,"mat-icon"),d.Dc(2,"unfold_more"),d.Sb(),d.Sb())}function y(t,e){1&t&&(d.Tb(0,"th",23),d.Dc(1),d.fc(2,"translate"),d.Sb()),2&t&&(d.Bb(1),d.Ec(d.gc(2,1,"CollectionSiteName")))}function P(t,e){1&t&&(d.Tb(0,"td",25),d.Tb(1,"mat-form-field",26),d.Ob(2,"input",27),d.fc(3,"translate"),d.Sb(),d.Sb()),2&t&&(d.kc("formGroupName",e.index),d.Bb(2),d.lc("placeholder",d.gc(3,2,"Name")))}function E(t,e){1&t&&(d.Tb(0,"th",23),d.Dc(1),d.fc(2,"translate"),d.Sb()),2&t&&(d.Bb(1),d.Ec(d.gc(2,1,"SpecificStartDate")))}function x(t,e){if(1&t&&(d.Tb(0,"td",28),d.Tb(1,"mat-form-field",26),d.Ob(2,"input",29),d.fc(3,"translate"),d.Ob(4,"mat-datepicker-toggle",30),d.Ob(5,"mat-datepicker",null,31),d.Sb(),d.Sb()),2&t){const t=e.index,i=d.qc(6);d.kc("formGroupName",t),d.Bb(2),d.lc("placeholder",d.gc(3,4,"StartDate")),d.kc("matDatepicker",i),d.Bb(2),d.kc("for",i)}}function C(t,e){1&t&&(d.Tb(0,"th",23),d.Dc(1),d.fc(2,"translate"),d.Sb()),2&t&&(d.Bb(1),d.Ec(d.gc(2,1,"SpecificEndDate")))}function R(t,e){if(1&t&&(d.Tb(0,"td",32),d.Tb(1,"mat-form-field",26),d.Ob(2,"input",33),d.fc(3,"translate"),d.Ob(4,"mat-datepicker-toggle",30),d.Ob(5,"mat-datepicker",null,34),d.Sb(),d.Sb()),2&t){const t=e.index,i=d.qc(6);d.kc("formGroupName",t),d.Bb(2),d.lc("placeholder",d.gc(3,4,"EndDate")),d.kc("matDatepicker",i),d.Bb(2),d.kc("for",i)}}function T(t,e){1&t&&d.Ob(0,"th",23)}function O(t,e){if(1&t){const t=d.Ub();d.Tb(0,"td",35),d.Tb(1,"button",36),d.ac("click",(function(){d.sc(t);const i=e.index;return d.ec().onRemoveEntity(i)})),d.Tb(2,"mat-icon"),d.Dc(3,"close"),d.Sb(),d.Sb(),d.Sb()}}function I(t,e){if(1&t){const t=d.Ub();d.Tb(0,"td",37),d.Tb(1,"button",38),d.ac("click",(function(){return d.sc(t),d.ec().onAddNewEntity()})),d.Tb(2,"mat-icon"),d.Dc(3,"add"),d.Sb(),d.Dc(4),d.fc(5,"translate"),d.Sb(),d.Sb()}if(2&t){const t=d.ec();d.Cb("colspan",t.entitiesDisplayedColumns.length),d.Bb(4),d.Fc("",d.gc(5,2,"Add")," ")}}function B(t,e){1&t&&d.Ob(0,"tr",39)}function k(t,e){1&t&&d.Ob(0,"tr",40)}function M(t,e){1&t&&d.Ob(0,"tr",41)}function N(t,e){1&t&&d.Ob(0,"th",23)}function j(t,e){1&t&&(d.Tb(0,"td",24),d.Tb(1,"mat-icon"),d.Dc(2,"unfold_more"),d.Sb(),d.Sb())}function L(t,e){1&t&&(d.Tb(0,"th",23),d.Dc(1),d.fc(2,"translate"),d.Sb()),2&t&&(d.Bb(1),d.Ec(d.gc(2,1,"GroupName")))}function G(t,e){1&t&&(d.Tb(0,"td",25),d.Tb(1,"mat-form-field",26),d.Ob(2,"input",27),d.fc(3,"translate"),d.Sb(),d.Sb()),2&t&&(d.kc("formGroupName",e.index),d.Bb(2),d.lc("placeholder",d.gc(3,2,"Name")))}function F(t,e){1&t&&(d.Tb(0,"th",23),d.Dc(1),d.fc(2,"translate"),d.Sb()),2&t&&(d.Bb(1),d.Ec(d.gc(2,1,"Members")))}function z(t,e){if(1&t){const t=d.Ub();d.Tb(0,"mat-chip",46),d.ac("removed",(function(){d.sc(t);const i=e.$implicit,n=d.ec().index;return d.ec().onEntityRemoved(n,i.id)})),d.Dc(1),d.Tb(2,"mat-icon",47),d.Dc(3,"cancel"),d.Sb(),d.Sb()}if(2&t){const t=e.$implicit;d.kc("removable",!0),d.Bb(1),d.Fc(" ",t.name," ")}}function A(t,e){if(1&t&&(d.Tb(0,"mat-option",48),d.Dc(1),d.Sb()),2&t){const t=e.$implicit;d.kc("value",t.id),d.Bb(1),d.Fc("",t.name," ")}}function H(t,e){if(1&t&&(d.Tb(0,"td",42),d.Tb(1,"mat-form-field",26),d.Tb(2,"mat-select",43),d.fc(3,"translate"),d.Tb(4,"mat-select-trigger"),d.Tb(5,"mat-chip-list"),d.Bc(6,z,4,2,"mat-chip",44),d.Sb(),d.Sb(),d.Bc(7,A,2,2,"mat-option",45),d.Sb(),d.Sb(),d.Sb()),2&t){const t=e.index,i=d.ec();d.kc("formGroupName",t),d.Bb(2),d.lc("placeholder",d.gc(3,4,"CollectionSites")),d.Bb(4),d.kc("ngForOf",i.selectedEntities[t]),d.Bb(1),d.kc("ngForOf",i.entities.value)}}function V(t,e){1&t&&d.Ob(0,"th",23)}function X(t,e){if(1&t){const t=d.Ub();d.Tb(0,"td",35),d.Tb(1,"button",36),d.ac("click",(function(){d.sc(t);const i=e.index;return d.ec().onRemoveGroup(i)})),d.Tb(2,"mat-icon"),d.Dc(3,"close"),d.Sb(),d.Sb(),d.Sb()}}function U(t,e){if(1&t){const t=d.Ub();d.Tb(0,"td",37),d.Tb(1,"button",38),d.ac("click",(function(){return d.sc(t),d.ec().onAddNewGroup()})),d.Tb(2,"mat-icon"),d.Dc(3,"add"),d.Sb(),d.Dc(4),d.fc(5,"translate"),d.Sb(),d.Sb()}if(2&t){const t=d.ec();d.Cb("colspan",t.groupsDisplayedColumns.length),d.Bb(4),d.Fc("",d.gc(5,2,"Add")," ")}}function q(t,e){1&t&&d.Ob(0,"tr",39)}function Z(t,e){1&t&&d.Ob(0,"tr",40)}function Q(t,e){1&t&&d.Ob(0,"tr",41)}const Y=function(){return["add"]},$=[{path:"",component:(()=>{class t{constructor(t,e){this.projectService=t,this.fb=e,this.entitiesDisplayedColumns=["position","name","start","end","delete"],this.entitiesDataSource=new a.o,this.groupsDisplayedColumns=["position","name","sites","delete"],this.groupsDataSource=new a.o,this.subscription=new h.a}get entities(){return this.sitesForm.get("entities")}get groups(){return this.sitesForm.get("groups")}get selectedEntities(){return this.groups.value.map(t=>this.entities.value.filter(e=>t.members.includes(e.id)))}ngOnInit(){this.subscription.add(this.projectService.openedProject.subscribe(t=>{this.project&&t.id===this.project.id&&t.rev===this.project.rev||(this.project=t,this.sitesForm=this.fb.group({entities:this.fb.array(this.project.entities.map(t=>this.newEntity(t))),groups:this.fb.array(this.project.groups.map(t=>this.newGroup(t)))}),this.entitiesDataSource.data=this.entities.controls,this.groupsDataSource.data=this.groups.controls,this.sitesForm.valueChanges.subscribe(e=>{e.entities=e.entities.map(t=>new c.a(t));const i=[];e.groups.forEach(t=>{const n=new l.a(t),s=t.members;n.members=e.entities.filter(t=>s.includes(t.id)),i.push(n)}),e.groups=i,this.projectService.project.next(Object.assign(t,e))}))}))}onAddNewEntity(){this.entities.push(this.newEntity()),this.entitiesDataSource.data=this.entities.controls}newEntity(t){return t||(t=new c.a),this.fb.group({id:[t.id,r.x.required],name:[t.name,r.x.required],start:[t.start],end:[t.end]})}onRemoveEntity(t){this.entities.removeAt(t),this.entitiesDataSource.data=this.entities.controls}onEntityRemoved(t,e){const i=this.groups.controls[t].controls.members;i.setValue(i.value.filter(t=>t!==e))}onAddNewGroup(){this.groups.push(this.newGroup()),this.groupsDataSource.data=this.groups.controls}newGroup(t){return t||(t=new l.a),this.fb.group({name:[t.name,r.x.required],members:[t.members.map(t=>t.id)]})}onRemoveGroup(t){this.groups.removeAt(t),this.groupsDataSource.data=this.groups.controls}}return t.\u0275fac=function(e){return new(e||t)(d.Nb(p.a),d.Nb(r.f))},t.\u0275cmp=d.Hb({type:t,selectors:[["app-sites"]],decls:61,vars:30,consts:[[1,"info-section","blue"],[1,"mdm-section",3,"formGroup"],[1,"mdm-title"],["mat-table","","formArrayName","entities",1,"mdm-table",3,"dataSource"],["matColumnDef","position"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","id","position",4,"matCellDef"],["matColumnDef","name"],["mat-cell","","id","name",3,"formGroupName",4,"matCellDef"],["matColumnDef","start"],["mat-cell","","id","start",3,"formGroupName",4,"matCellDef"],["matColumnDef","end"],["mat-cell","","id","end",3,"formGroupName",4,"matCellDef"],["matColumnDef","delete"],["mat-cell","","id","delete",4,"matCellDef"],["matColumnDef","add"],["mat-footer-cell","","class","add-row",4,"matFooterCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef"],["mat-table","","formArrayName","groups",1,"mdm-table",3,"dataSource"],["matColumnDef","sites"],["mat-cell","","id","sites",3,"formGroupName",4,"matCellDef"],["mat-header-cell",""],["mat-cell","","id","position"],["mat-cell","","id","name",3,"formGroupName"],["appearance","outline",1,"mdm-form-field"],["matInput","","formControlName","name",3,"placeholder"],["mat-cell","","id","start",3,"formGroupName"],["matInput","","formControlName","start",3,"matDatepicker","placeholder"],["matSuffix","",3,"for"],["startPicker",""],["mat-cell","","id","end",3,"formGroupName"],["matInput","","formControlName","end",3,"matDatepicker","placeholder"],["endPicker",""],["mat-cell","","id","delete"],["mat-icon-button","","color","warn",3,"click"],["mat-footer-cell","",1,"add-row"],["mat-stroked-button","",1,"mdm-button","small-button",3,"click"],["mat-header-row",""],["mat-row",""],["mat-footer-row",""],["mat-cell","","id","sites",3,"formGroupName"],["formControlName","members","multiple","",3,"placeholder"],[3,"removable","removed",4,"ngFor","ngForOf"],[3,"value",4,"ngFor","ngForOf"],[3,"removable","removed"],["matChipRemove",""],[3,"value"]],template:function(t,e){1&t&&(d.Tb(0,"div",0),d.Tb(1,"p"),d.Dc(2),d.fc(3,"translate"),d.Sb(),d.Tb(4,"p"),d.Dc(5),d.fc(6,"translate"),d.Sb(),d.Tb(7,"ul"),d.Tb(8,"li"),d.Dc(9),d.fc(10,"translate"),d.Sb(),d.Tb(11,"li"),d.Dc(12),d.fc(13,"translate"),d.Sb(),d.Sb(),d.Sb(),d.Tb(14,"div",1),d.Tb(15,"div",2),d.Dc(16),d.fc(17,"translate"),d.Sb(),d.Tb(18,"table",3),d.Rb(19,4),d.Bc(20,S,1,0,"th",5),d.Bc(21,w,3,0,"td",6),d.Qb(),d.Rb(22,7),d.Bc(23,y,3,3,"th",5),d.Bc(24,P,4,4,"td",8),d.Qb(),d.Rb(25,9),d.Bc(26,E,3,3,"th",5),d.Bc(27,x,7,6,"td",10),d.Qb(),d.Rb(28,11),d.Bc(29,C,3,3,"th",5),d.Bc(30,R,7,6,"td",12),d.Qb(),d.Rb(31,13),d.Bc(32,T,1,0,"th",5),d.Bc(33,O,4,0,"td",14),d.Qb(),d.Rb(34,15),d.Bc(35,I,6,4,"td",16),d.Qb(),d.Bc(36,B,1,0,"tr",17),d.Bc(37,k,1,0,"tr",18),d.Bc(38,M,1,0,"tr",19),d.Sb(),d.Sb(),d.Tb(39,"div",1),d.Tb(40,"div",2),d.Dc(41),d.fc(42,"translate"),d.Sb(),d.Tb(43,"table",20),d.Rb(44,4),d.Bc(45,N,1,0,"th",5),d.Bc(46,j,3,0,"td",6),d.Qb(),d.Rb(47,7),d.Bc(48,L,3,3,"th",5),d.Bc(49,G,4,4,"td",8),d.Qb(),d.Rb(50,21),d.Bc(51,F,3,3,"th",5),d.Bc(52,H,8,6,"td",22),d.Qb(),d.Rb(53,13),d.Bc(54,V,1,0,"th",5),d.Bc(55,X,4,0,"td",14),d.Qb(),d.Rb(56,15),d.Bc(57,U,6,4,"td",16),d.Qb(),d.Bc(58,q,1,0,"tr",17),d.Bc(59,Z,1,0,"tr",18),d.Bc(60,Q,1,0,"tr",19),d.Sb(),d.Sb()),2&t&&(d.Bb(2),d.Ec(d.gc(3,16,"ProjectSitesInfo.0")),d.Bb(3),d.Ec(d.gc(6,18,"ProjectSitesInfo.1")),d.Bb(4),d.Ec(d.gc(10,20,"ProjectSitesInfo.2")),d.Bb(3),d.Ec(d.gc(13,22,"ProjectSitesInfo.3")),d.Bb(2),d.kc("formGroup",e.sitesForm),d.Bb(2),d.Ec(d.gc(17,24,"CollectionSites")),d.Bb(2),d.kc("dataSource",e.entitiesDataSource),d.Bb(18),d.kc("matHeaderRowDef",e.entitiesDisplayedColumns),d.Bb(1),d.kc("matRowDefColumns",e.entitiesDisplayedColumns),d.Bb(1),d.kc("matFooterRowDef",d.nc(28,Y)),d.Bb(1),d.kc("formGroup",e.sitesForm),d.Bb(2),d.Ec(d.gc(42,26,"Groups")),d.Bb(2),d.kc("dataSource",e.groupsDataSource),d.Bb(15),d.kc("matHeaderRowDef",e.groupsDisplayedColumns),d.Bb(1),d.kc("matRowDefColumns",e.groupsDisplayedColumns),d.Bb(1),d.kc("matFooterRowDef",d.nc(29,Y)))},directives:[r.s,r.k,a.n,r.e,a.c,a.i,a.b,a.e,a.k,a.m,a.g,a.h,a.a,_.a,r.l,m.b,u.b,r.c,r.r,r.i,g.b,g.d,m.h,g.a,b.a,a.d,a.j,a.l,a.f,f.a,f.c,v.b,n.k,v.a,v.c,D.m],pipes:[s.c],styles:[".add-row[_ngcontent-%COMP%]{text-align:center}.mdm-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:14px}.mdm-table[_ngcontent-%COMP%]   td.mat-cell[_ngcontent-%COMP%]:first-of-type, .mdm-table[_ngcontent-%COMP%]   td.mat-cell[_ngcontent-%COMP%]:last-of-type, .mdm-table[_ngcontent-%COMP%]   td.mat-footer-cell[_ngcontent-%COMP%]:first-of-type, .mdm-table[_ngcontent-%COMP%]   td.mat-footer-cell[_ngcontent-%COMP%]:last-of-type, .mdm-table[_ngcontent-%COMP%]   th.mat-header-cell[_ngcontent-%COMP%]:first-of-type, .mdm-table[_ngcontent-%COMP%]   th.mat-header-cell[_ngcontent-%COMP%]:last-of-type{padding:4px;text-align:center}"]}),t})()}];let W=(()=>{class t{}return t.\u0275mod=d.Lb({type:t}),t.\u0275inj=d.Kb({factory:function(e){return new(e||t)},imports:[[o.f.forChild($)],o.f]}),t})();var K=i("bSwM"),J=i("7EHt"),tt=i("vxfF"),et=i("nLfN"),it=i("8LU1"),nt=i("XNiG"),st=i("HDdC"),ot=i("D0XW"),rt=i("Y7HM");function at(t){const{subscriber:e,counter:i,period:n}=t;e.next(i),this.schedule({subscriber:e,counter:i+1,period:n},n)}var ct=i("eNwd"),lt=(i("VRyK"),i("1G5W"));function ht(t,e){for(let i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function dt(t,e){const i=e?"":"none";ht(t.style,{touchAction:e?"":"none",webkitUserDrag:e?"":"none",webkitTapHighlightColor:e?"":"transparent",userSelect:i,msUserSelect:i,webkitUserSelect:i,MozUserSelect:i})}function pt(t){const e=t.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(t)*e}function _t(t,e){return t.getPropertyValue(e).split(",").map(t=>t.trim())}function mt(t){const e=t.getBoundingClientRect();return{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height}}function ut(t,e,i){const{top:n,bottom:s,left:o,right:r}=t;return i>=n&&i<=s&&e>=o&&e<=r}function gt(t,e,i){t.top+=e,t.bottom=t.top+t.height,t.left+=i,t.right=t.left+t.width}function bt(t,e,i,n){const{top:s,right:o,bottom:r,left:a,width:c,height:l}=t,h=c*e,d=l*e;return n>s-d&&n<r+d&&i>a-h&&i<o+h}i("JX91"),i("lJxs"),i("IzEk"),i("vkgz"),i("eIep"),i("cH1L");class ft{constructor(t,e){this._document=t,this._viewportRuler=e,this.positions=new Map}clear(){this.positions.clear()}cache(t){this.clear(),this.positions.set(this._document,{scrollPosition:this._viewportRuler.getViewportScrollPosition()}),t.forEach(t=>{this.positions.set(t,{scrollPosition:{top:t.scrollTop,left:t.scrollLeft},clientRect:mt(t)})})}handleScroll(t){const e=t.target,i=this.positions.get(e);if(!i)return null;const n=e===this._document?e.documentElement:e,s=i.scrollPosition;let o,r;if(e===this._document){const t=this._viewportRuler.getViewportScrollPosition();o=t.top,r=t.left}else o=e.scrollTop,r=e.scrollLeft;const a=s.top-o,c=s.left-r;return this.positions.forEach((t,i)=>{t.clientRect&&e!==i&&n.contains(i)&&gt(t.clientRect,a,c)}),s.top=o,s.left=r,{top:a,left:c}}}function vt(t){const e=t.cloneNode(!0),i=e.querySelectorAll("[id]"),n=t.nodeName.toLowerCase();e.removeAttribute("id");for(let s=0;s<i.length;s++)i[s].removeAttribute("id");return"canvas"===n?yt(t,e):"input"!==n&&"select"!==n&&"textarea"!==n||wt(t,e),Dt("canvas",t,e,yt),Dt("input, textarea, select",t,e,wt),e}function Dt(t,e,i,n){const s=e.querySelectorAll(t);if(s.length){const e=i.querySelectorAll(t);for(let t=0;t<s.length;t++)n(s[t],e[t])}}let St=0;function wt(t,e){e.value=t.value,"radio"===e.type&&e.name&&(e.name=`mat-clone-${e.name}-${St++}`)}function yt(t,e){const i=e.getContext("2d");if(i)try{i.drawImage(t,0,0)}catch(n){}}const Pt=Object(et.f)({passive:!0}),Et=Object(et.f)({passive:!1});class xt{constructor(t,e,i,n,s,o){this._config=e,this._document=i,this._ngZone=n,this._viewportRuler=s,this._dragDropRegistry=o,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._moveEvents=new nt.a,this._pointerMoveSubscription=h.a.EMPTY,this._pointerUpSubscription=h.a.EMPTY,this._scrollSubscription=h.a.EMPTY,this._resizeSubscription=h.a.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this._disabled=!1,this.beforeStarted=new nt.a,this.started=new nt.a,this.released=new nt.a,this.ended=new nt.a,this.entered=new nt.a,this.exited=new nt.a,this.dropped=new nt.a,this.moved=this._moveEvents,this._pointerDown=t=>{if(this.beforeStarted.next(),this._handles.length){const e=this._handles.find(e=>{const i=t.target;return!!i&&(i===e||e.contains(i))});!e||this._disabledHandles.has(e)||this.disabled||this._initializeDragSequence(e,t)}else this.disabled||this._initializeDragSequence(this._rootElement,t)},this._pointerMove=t=>{t.preventDefault();const e=this._getPointerPositionOnPage(t);if(!this._hasStartedDragging){if(Math.abs(e.x-this._pickupPositionOnPage.x)+Math.abs(e.y-this._pickupPositionOnPage.y)>=this._config.dragStartThreshold){if(!(Date.now()>=this._dragStartTime+this._getDragStartDelay(t)))return void this._endDragSequence(t);this._dropContainer&&this._dropContainer.isDragging()||(this._hasStartedDragging=!0,this._ngZone.run(()=>this._startDragSequence(t)))}return}this._boundaryElement&&(this._previewRect&&(this._previewRect.width||this._previewRect.height)||(this._previewRect=(this._preview||this._rootElement).getBoundingClientRect()));const i=this._getConstrainedPointerPosition(e);if(this._hasMoved=!0,this._lastKnownPointerPosition=e,this._updatePointerDirectionDelta(i),this._dropContainer)this._updateActiveDropContainer(i,e);else{const t=this._activeTransform;t.x=i.x-this._pickupPositionOnPage.x+this._passiveTransform.x,t.y=i.y-this._pickupPositionOnPage.y+this._passiveTransform.y,this._applyRootElementTransform(t.x,t.y),"undefined"!=typeof SVGElement&&this._rootElement instanceof SVGElement&&this._rootElement.setAttribute("transform",`translate(${t.x} ${t.y})`)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:i,event:t,distance:this._getDragDistance(i),delta:this._pointerDirectionDelta})})},this._pointerUp=t=>{this._endDragSequence(t)},this.withRootElement(t),this._parentPositions=new ft(i,s),o.registerDragItem(this)}get disabled(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)}set disabled(t){const e=Object(it.c)(t);e!==this._disabled&&(this._disabled=e,this._toggleNativeDragInteractions())}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(t){return this._handles=t.map(t=>Object(it.e)(t)),this._handles.forEach(t=>dt(t,!1)),this._toggleNativeDragInteractions(),this}withPreviewTemplate(t){return this._previewTemplate=t,this}withPlaceholderTemplate(t){return this._placeholderTemplate=t,this}withRootElement(t){const e=Object(it.e)(t);return e!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{e.addEventListener("mousedown",this._pointerDown,Et),e.addEventListener("touchstart",this._pointerDown,Pt)}),this._initialTransform=void 0,this._rootElement=e),"undefined"!=typeof SVGElement&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(t){return this._boundaryElement=t?Object(it.e)(t):null,this._resizeSubscription.unsubscribe(),t&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}dispose(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&Tt(this._rootElement),Tt(this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeSubscriptions(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=null}isDragging(){return this._hasStartedDragging&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(t){this._handles.indexOf(t)>-1&&this._disabledHandles.add(t)}enableHandle(t){this._disabledHandles.delete(t)}withDirection(t){return this._direction=t,this}_withDropContainer(t){this._dropContainer=t}getFreeDragPosition(){const t=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:t.x,y:t.y}}setFreeDragPosition(t){return this._activeTransform={x:0,y:0},this._passiveTransform.x=t.x,this._passiveTransform.y=t.y,this._dropContainer||this._applyRootElementTransform(t.x,t.y),this}_sortFromLastPointerPosition(){const t=this._lastKnownPointerPosition;t&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(t),t)}_removeSubscriptions(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe()}_destroyPreview(){this._preview&&Tt(this._preview),this._previewRef&&this._previewRef.destroy(),this._preview=this._previewRef=null}_destroyPlaceholder(){this._placeholder&&Tt(this._placeholder),this._placeholderRef&&this._placeholderRef.destroy(),this._placeholder=this._placeholderRef=null}_endDragSequence(t){this._dragDropRegistry.isDragging(this)&&(this._removeSubscriptions(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging&&(this.released.next({source:this}),this._dropContainer?(this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(t),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)})):(this._passiveTransform.x=this._activeTransform.x,this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(this._getPointerPositionOnPage(t))})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this))))}_startDragSequence(t){Ot(t)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();const e=this._dropContainer;if(e){const t=this._rootElement,n=t.parentNode,s=this._preview=this._createPreviewElement(),o=this._placeholder=this._createPlaceholderElement(),r=this._anchor=this._anchor||this._document.createComment("");n.insertBefore(r,t),t.style.display="none",this._document.body.appendChild(n.replaceChild(o,t)),(i=this._document,i.fullscreenElement||i.webkitFullscreenElement||i.mozFullScreenElement||i.msFullscreenElement||i.body).appendChild(s),this.started.next({source:this}),e.start(),this._initialContainer=e,this._initialIndex=e.getItemIndex(this)}else this.started.next({source:this}),this._initialContainer=this._initialIndex=void 0;var i;this._parentPositions.cache(e?e.getScrollableParents():[])}_initializeDragSequence(t,e){e.stopPropagation();const i=this.isDragging(),n=Ot(e),s=!n&&0!==e.button,o=this._rootElement,r=!n&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now();if(e.target&&e.target.draggable&&"mousedown"===e.type&&e.preventDefault(),i||s||r)return;this._handles.length&&(this._rootElementTapHighlight=o.style.webkitTapHighlightColor||"",o.style.webkitTapHighlightColor="transparent"),this._hasStartedDragging=this._hasMoved=!1,this._removeSubscriptions(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scroll.subscribe(t=>{this._updateOnScroll(t)}),this._boundaryElement&&(this._boundaryRect=mt(this._boundaryElement));const a=this._previewTemplate;this._pickupPositionInElement=a&&a.template&&!a.matchSize?{x:0,y:0}:this._getPointerPositionInElement(t,e);const c=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(e);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:c.x,y:c.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,e)}_cleanupDragArtifacts(t){this._rootElement.style.display="",this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._boundaryRect=this._previewRect=void 0,this._ngZone.run(()=>{const e=this._dropContainer,i=e.getItemIndex(this),n=this._getPointerPositionOnPage(t),s=this._getDragDistance(this._getPointerPositionOnPage(t)),o=e._isOverContainer(n.x,n.y);this.ended.next({source:this,distance:s}),this.dropped.next({item:this,currentIndex:i,previousIndex:this._initialIndex,container:e,previousContainer:this._initialContainer,isPointerOverContainer:o,distance:s}),e.drop(this,i,this._initialContainer,o,s,this._initialIndex),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:t,y:e},{x:i,y:n}){let s=this._initialContainer._getSiblingContainerFromPosition(this,t,e);!s&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(t,e)&&(s=this._initialContainer),s&&s!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=s,this._dropContainer.enter(this,t,e,s===this._initialContainer&&s.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:s,currentIndex:s.getItemIndex(this)})}),this._dropContainer._startScrollingIfNecessary(i,n),this._dropContainer._sortItem(this,t,e,this._pointerDirectionDelta),this._preview.style.transform=Ct(t-this._pickupPositionInElement.x,e-this._pickupPositionInElement.y)}_createPreviewElement(){const t=this._previewTemplate,e=this.previewClass,i=t?t.template:null;let n;if(i&&t){const e=t.matchSize?this._rootElement.getBoundingClientRect():null,s=t.viewContainer.createEmbeddedView(i,t.context);s.detectChanges(),n=It(s,this._document),this._previewRef=s,t.matchSize?Bt(n,e):n.style.transform=Ct(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else{const t=this._rootElement;n=vt(t),Bt(n,t.getBoundingClientRect())}return ht(n.style,{pointerEvents:"none",margin:"0",position:"fixed",top:"0",left:"0",zIndex:""+(this._config.zIndex||1e3)}),dt(n,!1),n.classList.add("cdk-drag-preview"),n.setAttribute("dir",this._direction),e&&(Array.isArray(e)?e.forEach(t=>n.classList.add(t)):n.classList.add(e)),n}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();const t=this._placeholder.getBoundingClientRect();this._preview.classList.add("cdk-drag-animating"),this._preview.style.transform=Ct(t.left,t.top);const e=function(t){const e=getComputedStyle(t),i=_t(e,"transition-property"),n=i.find(t=>"transform"===t||"all"===t);if(!n)return 0;const s=i.indexOf(n),o=_t(e,"transition-duration"),r=_t(e,"transition-delay");return pt(o[s])+pt(r[s])}(this._preview);return 0===e?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(t=>{const i=e=>{(!e||e.target===this._preview&&"transform"===e.propertyName)&&(this._preview.removeEventListener("transitionend",i),t(),clearTimeout(n))},n=setTimeout(i,1.5*e);this._preview.addEventListener("transitionend",i)}))}_createPlaceholderElement(){const t=this._placeholderTemplate,e=t?t.template:null;let i;return e?(this._placeholderRef=t.viewContainer.createEmbeddedView(e,t.context),this._placeholderRef.detectChanges(),i=It(this._placeholderRef,this._document)):i=vt(this._rootElement),i.classList.add("cdk-drag-placeholder"),i}_getPointerPositionInElement(t,e){const i=this._rootElement.getBoundingClientRect(),n=t===this._rootElement?null:t,s=n?n.getBoundingClientRect():i,o=Ot(e)?e.targetTouches[0]:e,r=this._getViewportScrollPosition();return{x:s.left-i.left+(o.pageX-s.left-r.left),y:s.top-i.top+(o.pageY-s.top-r.top)}}_getPointerPositionOnPage(t){const e=this._getViewportScrollPosition(),i=Ot(t)?t.touches[0]||t.changedTouches[0]||{pageX:0,pageY:0}:t,n=i.pageX-e.left,s=i.pageY-e.top;if(this._ownerSVGElement){const t=this._ownerSVGElement.getScreenCTM();if(t){const e=this._ownerSVGElement.createSVGPoint();return e.x=n,e.y=s,e.matrixTransform(t.inverse())}}return{x:n,y:s}}_getConstrainedPointerPosition(t){const e=this._dropContainer?this._dropContainer.lockAxis:null;let{x:i,y:n}=this.constrainPosition?this.constrainPosition(t,this):t;if("x"===this.lockAxis||"x"===e?n=this._pickupPositionOnPage.y:"y"!==this.lockAxis&&"y"!==e||(i=this._pickupPositionOnPage.x),this._boundaryRect){const{x:t,y:e}=this._pickupPositionInElement,s=this._boundaryRect,o=this._previewRect,r=s.top+e,a=s.bottom-(o.height-e);i=Rt(i,s.left+t,s.right-(o.width-t)),n=Rt(n,r,a)}return{x:i,y:n}}_updatePointerDirectionDelta(t){const{x:e,y:i}=t,n=this._pointerDirectionDelta,s=this._pointerPositionAtLastDirectionChange,o=Math.abs(e-s.x),r=Math.abs(i-s.y);return o>this._config.pointerDirectionChangeThreshold&&(n.x=e>s.x?1:-1,s.x=e),r>this._config.pointerDirectionChangeThreshold&&(n.y=i>s.y?1:-1,s.y=i),n}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;const t=this._handles.length>0||!this.isDragging();t!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=t,dt(this._rootElement,t))}_removeRootElementListeners(t){t.removeEventListener("mousedown",this._pointerDown,Et),t.removeEventListener("touchstart",this._pointerDown,Pt)}_applyRootElementTransform(t,e){const i=Ct(t,e);null==this._initialTransform&&(this._initialTransform=this._rootElement.style.transform||""),this._rootElement.style.transform=this._initialTransform?i+" "+this._initialTransform:i}_getDragDistance(t){const e=this._pickupPositionOnPage;return e?{x:t.x-e.x,y:t.y-e.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:t,y:e}=this._passiveTransform;if(0===t&&0===e||this.isDragging()||!this._boundaryElement)return;const i=this._boundaryElement.getBoundingClientRect(),n=this._rootElement.getBoundingClientRect();if(0===i.width&&0===i.height||0===n.width&&0===n.height)return;const s=i.left-n.left,o=n.right-i.right,r=i.top-n.top,a=n.bottom-i.bottom;i.width>n.width?(s>0&&(t+=s),o>0&&(t-=o)):t=0,i.height>n.height?(r>0&&(e+=r),a>0&&(e-=a)):e=0,t===this._passiveTransform.x&&e===this._passiveTransform.y||this.setFreeDragPosition({y:e,x:t})}_getDragStartDelay(t){const e=this.dragStartDelay;return"number"==typeof e?e:Ot(t)?e.touch:e?e.mouse:0}_updateOnScroll(t){const e=this._parentPositions.handleScroll(t);if(e){const i=t.target;this._boundaryRect&&(i===this._document||i!==this._boundaryElement&&i.contains(this._boundaryElement))&&gt(this._boundaryRect,e.top,e.left),this._pickupPositionOnPage.x+=e.left,this._pickupPositionOnPage.y+=e.top,this._dropContainer||(this._activeTransform.x-=e.left,this._activeTransform.y-=e.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){const t=this._parentPositions.positions.get(this._document);return t?t.scrollPosition:this._viewportRuler.getViewportScrollPosition()}}function Ct(t,e){return`translate3d(${Math.round(t)}px, ${Math.round(e)}px, 0)`}function Rt(t,e,i){return Math.max(e,Math.min(i,t))}function Tt(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function Ot(t){return"t"===t.type[0]}function It(t,e){const i=t.rootNodes;if(1===i.length&&i[0].nodeType===e.ELEMENT_NODE)return i[0];const n=e.createElement("div");return i.forEach(t=>n.appendChild(t)),n}function Bt(t,e){t.style.width=e.width+"px",t.style.height=e.height+"px",t.style.transform=Ct(e.left,e.top)}function kt(t,e){return Math.max(0,Math.min(e,t))}class Mt{constructor(t,e,i,n,s){this._dragDropRegistry=e,this._ngZone=n,this._viewportRuler=s,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.enterPredicate=()=>!0,this.beforeStarted=new nt.a,this.entered=new nt.a,this.exited=new nt.a,this.dropped=new nt.a,this.sorted=new nt.a,this._isDragging=!1,this._itemPositions=[],this._previousSwap={drag:null,delta:0,overlaps:!1},this._siblings=[],this._orientation="vertical",this._activeSiblings=new Set,this._direction="ltr",this._viewportScrollSubscription=h.a.EMPTY,this._verticalScrollDirection=0,this._horizontalScrollDirection=0,this._stopScrollTimers=new nt.a,this._cachedShadowRoot=null,this._startScrollInterval=()=>{this._stopScrolling(),function(t=0,e=ot.a){return(!Object(rt.a)(t)||t<0)&&(t=0),e&&"function"==typeof e.schedule||(e=ot.a),new st.a(i=>(i.add(e.schedule(at,t,{subscriber:i,counter:0,period:t})),i))}(0,ct.a).pipe(Object(lt.a)(this._stopScrollTimers)).subscribe(()=>{const t=this._scrollNode;1===this._verticalScrollDirection?jt(t,-2):2===this._verticalScrollDirection&&jt(t,2),1===this._horizontalScrollDirection?Lt(t,-2):2===this._horizontalScrollDirection&&Lt(t,2)})},this.element=Object(it.e)(t),this._document=i,this.withScrollableParents([this.element]),e.registerDropContainer(this),this._parentPositions=new ft(i,s)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){const t=Object(it.e)(this.element).style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=t.msScrollSnapType||t.scrollSnapType||"",t.scrollSnapType=t.msScrollSnapType="none",this._cacheItems(),this._siblings.forEach(t=>t._startReceiving(this)),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}enter(t,e,i,n){let s;this.start(),null==n?(s=this.sortingDisabled?this._draggables.indexOf(t):-1,-1===s&&(s=this._getItemIndexFromPointerPosition(t,e,i))):s=n;const o=this._activeDraggables,r=o.indexOf(t),a=t.getPlaceholderElement();let c=o[s];if(c===t&&(c=o[s+1]),r>-1&&o.splice(r,1),c&&!this._dragDropRegistry.isDragging(c)){const e=c.getRootElement();e.parentElement.insertBefore(a,e),o.splice(s,0,t)}else if(this._shouldEnterAsFirstChild(e,i)){const e=o[0].getRootElement();e.parentNode.insertBefore(a,e),o.unshift(t)}else Object(it.e)(this.element).appendChild(a),o.push(t);a.style.transform="",this._cacheItemPositions(),this._cacheParentPositions(),this.entered.next({item:t,container:this,currentIndex:this.getItemIndex(t)})}exit(t){this._reset(),this.exited.next({item:t,container:this})}drop(t,e,i,n,s,o){this._reset(),null==o&&(o=i.getItemIndex(t)),this.dropped.next({item:t,currentIndex:e,previousIndex:o,container:this,previousContainer:i,isPointerOverContainer:n,distance:s})}withItems(t){const e=this._draggables;return this._draggables=t,t.forEach(t=>t._withDropContainer(this)),this.isDragging()&&(e.filter(t=>t.isDragging()).every(e=>-1===t.indexOf(e))?this._reset():this._cacheItems()),this}withDirection(t){return this._direction=t,this}connectedTo(t){return this._siblings=t.slice(),this}withOrientation(t){return this._orientation=t,this}withScrollableParents(t){const e=Object(it.e)(this.element);return this._scrollableElements=-1===t.indexOf(e)?[e,...t]:t.slice(),this}getScrollableParents(){return this._scrollableElements}getItemIndex(t){return this._isDragging?Nt("horizontal"===this._orientation&&"rtl"===this._direction?this._itemPositions.slice().reverse():this._itemPositions,e=>e.drag===t):this._draggables.indexOf(t)}isReceiving(){return this._activeSiblings.size>0}_sortItem(t,e,i,n){if(this.sortingDisabled||!bt(this._clientRect,.05,e,i))return;const s=this._itemPositions,o=this._getItemIndexFromPointerPosition(t,e,i,n);if(-1===o&&s.length>0)return;const r="horizontal"===this._orientation,a=Nt(s,e=>e.drag===t),c=s[o],l=c.clientRect,h=a>o?1:-1,d=this._getItemOffsetPx(s[a].clientRect,l,h),p=this._getSiblingOffsetPx(a,s,h),_=s.slice();!function(t,e,i){const n=kt(e,t.length-1),s=kt(i,t.length-1);if(n===s)return;const o=t[n],r=s<n?-1:1;for(let a=n;a!==s;a+=r)t[a]=t[a+r];t[s]=o}(s,a,o),this.sorted.next({previousIndex:a,currentIndex:o,container:this,item:t}),s.forEach((e,i)=>{if(_[i]===e)return;const n=e.drag===t,s=n?d:p,o=n?t.getPlaceholderElement():e.drag.getRootElement();e.offset+=s,r?(o.style.transform=`translate3d(${Math.round(e.offset)}px, 0, 0)`,gt(e.clientRect,0,s)):(o.style.transform=`translate3d(0, ${Math.round(e.offset)}px, 0)`,gt(e.clientRect,s,0))}),this._previousSwap.overlaps=ut(l,e,i),this._previousSwap.drag=c.drag,this._previousSwap.delta=r?n.x:n.y}_startScrollingIfNecessary(t,e){if(this.autoScrollDisabled)return;let i,n=0,s=0;if(this._parentPositions.positions.forEach((o,r)=>{r!==this._document&&o.clientRect&&!i&&bt(o.clientRect,.05,t,e)&&([n,s]=function(t,e,i,n){const s=Gt(e,n),o=Ft(e,i);let r=0,a=0;if(s){const e=t.scrollTop;1===s?e>0&&(r=1):t.scrollHeight-e>t.clientHeight&&(r=2)}if(o){const e=t.scrollLeft;1===o?e>0&&(a=1):t.scrollWidth-e>t.clientWidth&&(a=2)}return[r,a]}(r,o.clientRect,t,e),(n||s)&&(i=r))}),!n&&!s){const{width:o,height:r}=this._viewportRuler.getViewportSize(),a={width:o,height:r,top:0,right:o,bottom:r,left:0};n=Gt(a,e),s=Ft(a,t),i=window}!i||n===this._verticalScrollDirection&&s===this._horizontalScrollDirection&&i===this._scrollNode||(this._verticalScrollDirection=n,this._horizontalScrollDirection=s,this._scrollNode=i,(n||s)&&i?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_cacheParentPositions(){const t=Object(it.e)(this.element);this._parentPositions.cache(this._scrollableElements),this._clientRect=this._parentPositions.positions.get(t).clientRect}_cacheItemPositions(){const t="horizontal"===this._orientation;this._itemPositions=this._activeDraggables.map(t=>{const e=t.getVisibleElement();return{drag:t,offset:0,clientRect:mt(e)}}).sort((e,i)=>t?e.clientRect.left-i.clientRect.left:e.clientRect.top-i.clientRect.top)}_reset(){this._isDragging=!1;const t=Object(it.e)(this.element).style;t.scrollSnapType=t.msScrollSnapType=this._initialScrollSnap,this._activeDraggables.forEach(t=>{const e=t.getRootElement();e&&(e.style.transform="")}),this._siblings.forEach(t=>t._stopReceiving(this)),this._activeDraggables=[],this._itemPositions=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1,this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_getSiblingOffsetPx(t,e,i){const n="horizontal"===this._orientation,s=e[t].clientRect,o=e[t+-1*i];let r=s[n?"width":"height"]*i;if(o){const t=n?"left":"top",e=n?"right":"bottom";-1===i?r-=o.clientRect[t]-s[e]:r+=s[t]-o.clientRect[e]}return r}_getItemOffsetPx(t,e,i){const n="horizontal"===this._orientation;let s=n?e.left-t.left:e.top-t.top;return-1===i&&(s+=n?e.width-t.width:e.height-t.height),s}_shouldEnterAsFirstChild(t,e){if(!this._activeDraggables.length)return!1;const i=this._itemPositions,n="horizontal"===this._orientation;if(i[0].drag!==this._activeDraggables[0]){const s=i[i.length-1].clientRect;return n?t>=s.right:e>=s.bottom}{const s=i[0].clientRect;return n?t<=s.left:e<=s.top}}_getItemIndexFromPointerPosition(t,e,i,n){const s="horizontal"===this._orientation;return Nt(this._itemPositions,({drag:o,clientRect:r},a,c)=>{if(o===t)return c.length<2;if(n){const t=s?n.x:n.y;if(o===this._previousSwap.drag&&this._previousSwap.overlaps&&t===this._previousSwap.delta)return!1}return s?e>=Math.floor(r.left)&&e<Math.floor(r.right):i>=Math.floor(r.top)&&i<Math.floor(r.bottom)})}_cacheItems(){this._activeDraggables=this._draggables.slice(),this._cacheItemPositions(),this._cacheParentPositions()}_isOverContainer(t,e){return ut(this._clientRect,t,e)}_getSiblingContainerFromPosition(t,e,i){return this._siblings.find(n=>n._canReceive(t,e,i))}_canReceive(t,e,i){if(!ut(this._clientRect,e,i)||!this.enterPredicate(t,this))return!1;const n=this._getShadowRoot().elementFromPoint(e,i);if(!n)return!1;const s=Object(it.e)(this.element);return n===s||s.contains(n)}_startReceiving(t){const e=this._activeSiblings;e.has(t)||(e.add(t),this._cacheParentPositions(),this._listenToScrollEvents())}_stopReceiving(t){this._activeSiblings.delete(t),this._viewportScrollSubscription.unsubscribe()}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scroll.subscribe(t=>{if(this.isDragging()){const e=this._parentPositions.handleScroll(t);e&&(this._itemPositions.forEach(({clientRect:t})=>{gt(t,e.top,e.left)}),this._itemPositions.forEach(({drag:t})=>{this._dragDropRegistry.isDragging(t)&&t._sortFromLastPointerPosition()}))}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){const t=Object(et.c)(Object(it.e)(this.element));this._cachedShadowRoot=t||this._document}return this._cachedShadowRoot}}function Nt(t,e){for(let i=0;i<t.length;i++)if(e(t[i],i,t))return i;return-1}function jt(t,e){t===window?t.scrollBy(0,e):t.scrollTop+=e}function Lt(t,e){t===window?t.scrollBy(e,0):t.scrollLeft+=e}function Gt(t,e){const{top:i,bottom:n,height:s}=t,o=.05*s;return e>=i-o&&e<=i+o?1:e>=n-o&&e<=n+o?2:0}function Ft(t,e){const{left:i,right:n,width:s}=t,o=.05*s;return e>=i-o&&e<=i+o?1:e>=n-o&&e<=n+o?2:0}const zt=Object(et.f)({passive:!1,capture:!0});let At=(()=>{class t{constructor(t,e){this._ngZone=t,this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=new Set,this._globalListeners=new Map,this.pointerMove=new nt.a,this.pointerUp=new nt.a,this.scroll=new nt.a,this._preventDefaultWhileDragging=t=>{this._activeDragInstances.size&&t.preventDefault()},this._document=e}registerDropContainer(t){this._dropInstances.has(t)||this._dropInstances.add(t)}registerDragItem(t){this._dragInstances.add(t),1===this._dragInstances.size&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._preventDefaultWhileDragging,zt)})}removeDropContainer(t){this._dropInstances.delete(t)}removeDragItem(t){this._dragInstances.delete(t),this.stopDragging(t),0===this._dragInstances.size&&this._document.removeEventListener("touchmove",this._preventDefaultWhileDragging,zt)}startDragging(t,e){if(!this._activeDragInstances.has(t)&&(this._activeDragInstances.add(t),1===this._activeDragInstances.size)){const t=e.type.startsWith("touch"),i=t?"touchend":"mouseup";this._globalListeners.set(t?"touchmove":"mousemove",{handler:t=>this.pointerMove.next(t),options:zt}).set(i,{handler:t=>this.pointerUp.next(t),options:!0}).set("scroll",{handler:t=>this.scroll.next(t),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:zt}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((t,e)=>{this._document.addEventListener(e,t.handler,t.options)})})}}stopDragging(t){this._activeDragInstances.delete(t),0===this._activeDragInstances.size&&this._clearGlobalListeners()}isDragging(t){return this._activeDragInstances.has(t)}ngOnDestroy(){this._dragInstances.forEach(t=>this.removeDragItem(t)),this._dropInstances.forEach(t=>this.removeDropContainer(t)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_clearGlobalListeners(){this._globalListeners.forEach((t,e)=>{this._document.removeEventListener(e,t.handler,t.options)}),this._globalListeners.clear()}}return t.\u0275fac=function(e){return new(e||t)(d.Xb(d.B),d.Xb(n.d))},t.\u0275prov=Object(d.Jb)({factory:function(){return new t(Object(d.Xb)(d.B),Object(d.Xb)(n.d))},token:t,providedIn:"root"}),t})();const Ht={dragStartThreshold:5,pointerDirectionChangeThreshold:5};let Vt=(()=>{class t{constructor(t,e,i,n){this._document=t,this._ngZone=e,this._viewportRuler=i,this._dragDropRegistry=n}createDrag(t,e=Ht){return new xt(t,e,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(t){return new Mt(t,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}}return t.\u0275fac=function(e){return new(e||t)(d.Xb(n.d),d.Xb(d.B),d.Xb(tt.e),d.Xb(At))},t.\u0275prov=Object(d.Jb)({factory:function(){return new t(Object(d.Xb)(n.d),Object(d.Xb)(d.B),Object(d.Xb)(tt.e),Object(d.Xb)(At))},token:t,providedIn:"root"}),t})(),Xt=(()=>{class t{}return t.\u0275mod=d.Lb({type:t}),t.\u0275inj=d.Kb({factory:function(e){return new(e||t)},providers:[Vt],imports:[tt.b]}),t})();var Ut=i("f6nW");let qt=(()=>{class t{}return t.\u0275mod=d.Lb({type:t}),t.\u0275inj=d.Kb({factory:function(e){return new(e||t)},imports:[[n.c,s.b,r.m,r.w,u.c,m.d,f.b,b.b,_.b,J.b,K.b,g.c,D.k,v.d,a.p,Xt,Ut.r,W]]}),t})()}}]);