!function(){function t(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,r=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(i.push(s.value),!e||i.length!==e);n=!0);}catch(c){r=!0,o=c}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return i}(t,e)||i(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||i(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){if(t){if("string"==typeof t)return n(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(t,e):void 0}}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,i){return e&&o(t.prototype,e),i&&o(t,i),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{o0HM:function(i,n,o){"use strict";o.r(n),o.d(n,"SitesModule",(function(){return ie}));var a=o("ofXK"),c=o("sYmb"),l=o("tyNb"),h=o("3Pt+"),u=o("+0xr"),d=o("D//C"),p=o("XOCf"),f=o("quSY"),m=o("fXoL"),_=o("c3AT"),g=o("NFeN"),v=o("kmnG"),b=o("qFsG"),y=o("iadO"),S=o("bTqV"),D=o("d3UM"),w=o("A5z7"),P=o("FKr1");function k(t,e){1&t&&m.Ob(0,"th",23)}function E(t,e){1&t&&(m.Tb(0,"td",24),m.Tb(1,"mat-icon"),m.Dc(2,"unfold_more"),m.Sb(),m.Sb())}function x(t,e){1&t&&(m.Tb(0,"th",23),m.Dc(1),m.fc(2,"translate"),m.Sb()),2&t&&(m.Bb(1),m.Ec(m.gc(2,1,"CollectionSiteName")))}function C(t,e){1&t&&(m.Tb(0,"td",25),m.Tb(1,"mat-form-field",26),m.Ob(2,"input",27),m.fc(3,"translate"),m.Sb(),m.Sb()),2&t&&(m.kc("formGroupName",e.index),m.Bb(2),m.lc("placeholder",m.gc(3,2,"Name")))}function R(t,e){1&t&&(m.Tb(0,"th",23),m.Dc(1),m.fc(2,"translate"),m.Sb()),2&t&&(m.Bb(1),m.Ec(m.gc(2,1,"SpecificStartDate")))}function T(t,e){if(1&t&&(m.Tb(0,"td",28),m.Tb(1,"mat-form-field",26),m.Ob(2,"input",29),m.fc(3,"translate"),m.Ob(4,"mat-datepicker-toggle",30),m.Ob(5,"mat-datepicker",null,31),m.Sb(),m.Sb()),2&t){var i=e.index,n=m.qc(6);m.kc("formGroupName",i),m.Bb(2),m.lc("placeholder",m.gc(3,4,"StartDate")),m.kc("matDatepicker",n),m.Bb(2),m.kc("for",n)}}function O(t,e){1&t&&(m.Tb(0,"th",23),m.Dc(1),m.fc(2,"translate"),m.Sb()),2&t&&(m.Bb(1),m.Ec(m.gc(2,1,"SpecificEndDate")))}function I(t,e){if(1&t&&(m.Tb(0,"td",32),m.Tb(1,"mat-form-field",26),m.Ob(2,"input",33),m.fc(3,"translate"),m.Ob(4,"mat-datepicker-toggle",30),m.Ob(5,"mat-datepicker",null,34),m.Sb(),m.Sb()),2&t){var i=e.index,n=m.qc(6);m.kc("formGroupName",i),m.Bb(2),m.lc("placeholder",m.gc(3,4,"EndDate")),m.kc("matDatepicker",n),m.Bb(2),m.kc("for",n)}}function B(t,e){1&t&&m.Ob(0,"th",23)}function M(t,e){if(1&t){var i=m.Ub();m.Tb(0,"td",35),m.Tb(1,"button",36),m.ac("click",(function(){m.sc(i);var t=e.index;return m.ec().onRemoveEntity(t)})),m.Tb(2,"mat-icon"),m.Dc(3,"close"),m.Sb(),m.Sb(),m.Sb()}}function N(t,e){if(1&t){var i=m.Ub();m.Tb(0,"td",37),m.Tb(1,"button",38),m.ac("click",(function(){return m.sc(i),m.ec().onAddNewEntity()})),m.Tb(2,"mat-icon"),m.Dc(3,"add"),m.Sb(),m.Dc(4),m.fc(5,"translate"),m.Sb(),m.Sb()}if(2&t){var n=m.ec();m.Cb("colspan",n.entitiesDisplayedColumns.length),m.Bb(4),m.Fc("",m.gc(5,2,"Add")," ")}}function j(t,e){1&t&&m.Ob(0,"tr",39)}function A(t,e){1&t&&m.Ob(0,"tr",40)}function L(t,e){1&t&&m.Ob(0,"tr",41)}function G(t,e){1&t&&m.Ob(0,"th",23)}function F(t,e){1&t&&(m.Tb(0,"td",24),m.Tb(1,"mat-icon"),m.Dc(2,"unfold_more"),m.Sb(),m.Sb())}function z(t,e){1&t&&(m.Tb(0,"th",23),m.Dc(1),m.fc(2,"translate"),m.Sb()),2&t&&(m.Bb(1),m.Ec(m.gc(2,1,"GroupName")))}function H(t,e){1&t&&(m.Tb(0,"td",25),m.Tb(1,"mat-form-field",26),m.Ob(2,"input",27),m.fc(3,"translate"),m.Sb(),m.Sb()),2&t&&(m.kc("formGroupName",e.index),m.Bb(2),m.lc("placeholder",m.gc(3,2,"Name")))}function V(t,e){1&t&&(m.Tb(0,"th",23),m.Dc(1),m.fc(2,"translate"),m.Sb()),2&t&&(m.Bb(1),m.Ec(m.gc(2,1,"Members")))}function U(t,e){if(1&t){var i=m.Ub();m.Tb(0,"mat-chip",46),m.ac("removed",(function(){m.sc(i);var t=e.$implicit,n=m.ec().index;return m.ec().onEntityRemoved(n,t.id)})),m.Dc(1),m.Tb(2,"mat-icon",47),m.Dc(3,"cancel"),m.Sb(),m.Sb()}if(2&t){var n=e.$implicit;m.kc("removable",!0),m.Bb(1),m.Fc(" ",n.name," ")}}function X(t,e){if(1&t&&(m.Tb(0,"mat-option",48),m.Dc(1),m.Sb()),2&t){var i=e.$implicit;m.kc("value",i.id),m.Bb(1),m.Fc("",i.name," ")}}function q(t,e){if(1&t&&(m.Tb(0,"td",42),m.Tb(1,"mat-form-field",26),m.Tb(2,"mat-select",43),m.fc(3,"translate"),m.Tb(4,"mat-select-trigger"),m.Tb(5,"mat-chip-list"),m.Bc(6,U,4,2,"mat-chip",44),m.Sb(),m.Sb(),m.Bc(7,X,2,2,"mat-option",45),m.Sb(),m.Sb(),m.Sb()),2&t){var i=e.index,n=m.ec();m.kc("formGroupName",i),m.Bb(2),m.lc("placeholder",m.gc(3,4,"CollectionSites")),m.Bb(4),m.kc("ngForOf",n.selectedEntities[i]),m.Bb(1),m.kc("ngForOf",n.entities.value)}}function Z(t,e){1&t&&m.Ob(0,"th",23)}function Q(t,e){if(1&t){var i=m.Ub();m.Tb(0,"td",35),m.Tb(1,"button",36),m.ac("click",(function(){m.sc(i);var t=e.index;return m.ec().onRemoveGroup(t)})),m.Tb(2,"mat-icon"),m.Dc(3,"close"),m.Sb(),m.Sb(),m.Sb()}}function Y(t,e){if(1&t){var i=m.Ub();m.Tb(0,"td",37),m.Tb(1,"button",38),m.ac("click",(function(){return m.sc(i),m.ec().onAddNewGroup()})),m.Tb(2,"mat-icon"),m.Dc(3,"add"),m.Sb(),m.Dc(4),m.fc(5,"translate"),m.Sb(),m.Sb()}if(2&t){var n=m.ec();m.Cb("colspan",n.groupsDisplayedColumns.length),m.Bb(4),m.Fc("",m.gc(5,2,"Add")," ")}}function W(t,e){1&t&&m.Ob(0,"tr",39)}function K(t,e){1&t&&m.Ob(0,"tr",40)}function J(t,e){1&t&&m.Ob(0,"tr",41)}var $,tt,et=function(){return["add"]},it=[{path:"",component:($=function(){function t(e,i){r(this,t),this.projectService=e,this.fb=i,this.entitiesDisplayedColumns=["position","name","start","end","delete"],this.entitiesDataSource=new u.o,this.groupsDisplayedColumns=["position","name","sites","delete"],this.groupsDataSource=new u.o,this.subscription=new f.a}return s(t,[{key:"ngOnInit",value:function(){var t=this;this.subscription.add(this.projectService.openedProject.subscribe((function(e){t.project&&e.id===t.project.id&&e.rev===t.project.rev||(t.project=e,t.sitesForm=t.fb.group({entities:t.fb.array(t.project.entities.map((function(e){return t.newEntity(e)}))),groups:t.fb.array(t.project.groups.map((function(e){return t.newGroup(e)})))}),t.entitiesDataSource.data=t.entities.controls,t.groupsDataSource.data=t.groups.controls,t.sitesForm.valueChanges.subscribe((function(i){i.entities=i.entities.map((function(t){return new d.a(t)}));var n=[];i.groups.forEach((function(t){var e=new p.a(t),r=t.members;e.members=i.entities.filter((function(t){return r.includes(t.id)})),n.push(e)})),i.groups=n,t.projectService.project.next(Object.assign(e,i))})))})))}},{key:"onAddNewEntity",value:function(){this.entities.push(this.newEntity()),this.entitiesDataSource.data=this.entities.controls}},{key:"newEntity",value:function(t){return t||(t=new d.a),this.fb.group({id:[t.id,h.x.required],name:[t.name,h.x.required],start:[t.start],end:[t.end]})}},{key:"onRemoveEntity",value:function(t){this.entities.removeAt(t),this.entitiesDataSource.data=this.entities.controls}},{key:"onEntityRemoved",value:function(t,e){var i=this.groups.controls[t].controls.members;i.setValue(i.value.filter((function(t){return t!==e})))}},{key:"onAddNewGroup",value:function(){this.groups.push(this.newGroup()),this.groupsDataSource.data=this.groups.controls}},{key:"newGroup",value:function(t){return t||(t=new p.a),this.fb.group({name:[t.name,h.x.required],members:[t.members.map((function(t){return t.id}))]})}},{key:"onRemoveGroup",value:function(t){this.groups.removeAt(t),this.groupsDataSource.data=this.groups.controls}},{key:"entities",get:function(){return this.sitesForm.get("entities")}},{key:"groups",get:function(){return this.sitesForm.get("groups")}},{key:"selectedEntities",get:function(){var t=this;return this.groups.value.map((function(e){return t.entities.value.filter((function(t){return e.members.includes(t.id)}))}))}}]),t}(),$.\u0275fac=function(t){return new(t||$)(m.Nb(_.a),m.Nb(h.f))},$.\u0275cmp=m.Hb({type:$,selectors:[["app-sites"]],decls:61,vars:30,consts:[[1,"info-section","blue"],[1,"mdm-section",3,"formGroup"],[1,"mdm-title"],["mat-table","","formArrayName","entities",1,"mdm-table",3,"dataSource"],["matColumnDef","position"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","id","position",4,"matCellDef"],["matColumnDef","name"],["mat-cell","","id","name",3,"formGroupName",4,"matCellDef"],["matColumnDef","start"],["mat-cell","","id","start",3,"formGroupName",4,"matCellDef"],["matColumnDef","end"],["mat-cell","","id","end",3,"formGroupName",4,"matCellDef"],["matColumnDef","delete"],["mat-cell","","id","delete",4,"matCellDef"],["matColumnDef","add"],["mat-footer-cell","","class","add-row",4,"matFooterCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef"],["mat-table","","formArrayName","groups",1,"mdm-table",3,"dataSource"],["matColumnDef","sites"],["mat-cell","","id","sites",3,"formGroupName",4,"matCellDef"],["mat-header-cell",""],["mat-cell","","id","position"],["mat-cell","","id","name",3,"formGroupName"],["appearance","outline",1,"mdm-form-field"],["matInput","","formControlName","name",3,"placeholder"],["mat-cell","","id","start",3,"formGroupName"],["matInput","","formControlName","start",3,"matDatepicker","placeholder"],["matSuffix","",3,"for"],["startPicker",""],["mat-cell","","id","end",3,"formGroupName"],["matInput","","formControlName","end",3,"matDatepicker","placeholder"],["endPicker",""],["mat-cell","","id","delete"],["mat-icon-button","","color","warn",3,"click"],["mat-footer-cell","",1,"add-row"],["mat-stroked-button","",1,"mdm-button","small-button",3,"click"],["mat-header-row",""],["mat-row",""],["mat-footer-row",""],["mat-cell","","id","sites",3,"formGroupName"],["formControlName","members","multiple","",3,"placeholder"],[3,"removable","removed",4,"ngFor","ngForOf"],[3,"value",4,"ngFor","ngForOf"],[3,"removable","removed"],["matChipRemove",""],[3,"value"]],template:function(t,e){1&t&&(m.Tb(0,"div",0),m.Tb(1,"p"),m.Dc(2),m.fc(3,"translate"),m.Sb(),m.Tb(4,"p"),m.Dc(5),m.fc(6,"translate"),m.Sb(),m.Tb(7,"ul"),m.Tb(8,"li"),m.Dc(9),m.fc(10,"translate"),m.Sb(),m.Tb(11,"li"),m.Dc(12),m.fc(13,"translate"),m.Sb(),m.Sb(),m.Sb(),m.Tb(14,"div",1),m.Tb(15,"div",2),m.Dc(16),m.fc(17,"translate"),m.Sb(),m.Tb(18,"table",3),m.Rb(19,4),m.Bc(20,k,1,0,"th",5),m.Bc(21,E,3,0,"td",6),m.Qb(),m.Rb(22,7),m.Bc(23,x,3,3,"th",5),m.Bc(24,C,4,4,"td",8),m.Qb(),m.Rb(25,9),m.Bc(26,R,3,3,"th",5),m.Bc(27,T,7,6,"td",10),m.Qb(),m.Rb(28,11),m.Bc(29,O,3,3,"th",5),m.Bc(30,I,7,6,"td",12),m.Qb(),m.Rb(31,13),m.Bc(32,B,1,0,"th",5),m.Bc(33,M,4,0,"td",14),m.Qb(),m.Rb(34,15),m.Bc(35,N,6,4,"td",16),m.Qb(),m.Bc(36,j,1,0,"tr",17),m.Bc(37,A,1,0,"tr",18),m.Bc(38,L,1,0,"tr",19),m.Sb(),m.Sb(),m.Tb(39,"div",1),m.Tb(40,"div",2),m.Dc(41),m.fc(42,"translate"),m.Sb(),m.Tb(43,"table",20),m.Rb(44,4),m.Bc(45,G,1,0,"th",5),m.Bc(46,F,3,0,"td",6),m.Qb(),m.Rb(47,7),m.Bc(48,z,3,3,"th",5),m.Bc(49,H,4,4,"td",8),m.Qb(),m.Rb(50,21),m.Bc(51,V,3,3,"th",5),m.Bc(52,q,8,6,"td",22),m.Qb(),m.Rb(53,13),m.Bc(54,Z,1,0,"th",5),m.Bc(55,Q,4,0,"td",14),m.Qb(),m.Rb(56,15),m.Bc(57,Y,6,4,"td",16),m.Qb(),m.Bc(58,W,1,0,"tr",17),m.Bc(59,K,1,0,"tr",18),m.Bc(60,J,1,0,"tr",19),m.Sb(),m.Sb()),2&t&&(m.Bb(2),m.Ec(m.gc(3,16,"ProjectSitesInfo.0")),m.Bb(3),m.Ec(m.gc(6,18,"ProjectSitesInfo.1")),m.Bb(4),m.Ec(m.gc(10,20,"ProjectSitesInfo.2")),m.Bb(3),m.Ec(m.gc(13,22,"ProjectSitesInfo.3")),m.Bb(2),m.kc("formGroup",e.sitesForm),m.Bb(2),m.Ec(m.gc(17,24,"CollectionSites")),m.Bb(2),m.kc("dataSource",e.entitiesDataSource),m.Bb(18),m.kc("matHeaderRowDef",e.entitiesDisplayedColumns),m.Bb(1),m.kc("matRowDefColumns",e.entitiesDisplayedColumns),m.Bb(1),m.kc("matFooterRowDef",m.nc(28,et)),m.Bb(1),m.kc("formGroup",e.sitesForm),m.Bb(2),m.Ec(m.gc(42,26,"Groups")),m.Bb(2),m.kc("dataSource",e.groupsDataSource),m.Bb(15),m.kc("matHeaderRowDef",e.groupsDisplayedColumns),m.Bb(1),m.kc("matRowDefColumns",e.groupsDisplayedColumns),m.Bb(1),m.kc("matFooterRowDef",m.nc(29,et)))},directives:[h.s,h.k,u.n,h.e,u.c,u.i,u.b,u.e,u.k,u.m,u.g,u.h,u.a,g.a,h.l,v.b,b.b,h.c,h.r,h.i,y.b,y.d,v.h,y.a,S.a,u.d,u.j,u.l,u.f,D.a,D.c,w.b,a.k,w.a,w.c,P.m],pipes:[c.c],styles:[".add-row[_ngcontent-%COMP%]{text-align:center}.mdm-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:14px}.mdm-table[_ngcontent-%COMP%]   td.mat-cell[_ngcontent-%COMP%]:first-of-type, .mdm-table[_ngcontent-%COMP%]   td.mat-cell[_ngcontent-%COMP%]:last-of-type, .mdm-table[_ngcontent-%COMP%]   td.mat-footer-cell[_ngcontent-%COMP%]:first-of-type, .mdm-table[_ngcontent-%COMP%]   td.mat-footer-cell[_ngcontent-%COMP%]:last-of-type, .mdm-table[_ngcontent-%COMP%]   th.mat-header-cell[_ngcontent-%COMP%]:first-of-type, .mdm-table[_ngcontent-%COMP%]   th.mat-header-cell[_ngcontent-%COMP%]:last-of-type{padding:4px;text-align:center}"]}),$)}],nt=((tt=function t(){r(this,t)}).\u0275mod=m.Lb({type:tt}),tt.\u0275inj=m.Kb({factory:function(t){return new(t||tt)},imports:[[l.f.forChild(it)],l.f]}),tt),rt=o("bSwM"),ot=o("7EHt"),st=o("vxfF"),at=o("nLfN"),ct=o("8LU1"),lt=o("XNiG"),ht=o("HDdC"),ut=o("D0XW"),dt=o("Y7HM");function pt(t){var e=t.subscriber,i=t.counter,n=t.period;e.next(i),this.schedule({subscriber:e,counter:i+1,period:n},n)}var ft=o("eNwd"),mt=(o("VRyK"),o("1G5W"));function _t(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function gt(t,e){var i=e?"":"none";_t(t.style,{touchAction:e?"":"none",webkitUserDrag:e?"":"none",webkitTapHighlightColor:e?"":"transparent",userSelect:i,msUserSelect:i,webkitUserSelect:i,MozUserSelect:i})}function vt(t){var e=t.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(t)*e}function bt(t,e){return t.getPropertyValue(e).split(",").map((function(t){return t.trim()}))}function yt(t){var e=t.getBoundingClientRect();return{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height}}function St(t,e,i){var n=t.top,r=t.bottom,o=t.left,s=t.right;return i>=n&&i<=r&&e>=o&&e<=s}function Dt(t,e,i){t.top+=e,t.bottom=t.top+t.height,t.left+=i,t.right=t.left+t.width}function wt(t,e,i,n){var r=t.top,o=t.right,s=t.bottom,a=t.left,c=t.width*e,l=t.height*e;return n>r-l&&n<s+l&&i>a-c&&i<o+c}o("JX91"),o("lJxs"),o("IzEk"),o("vkgz"),o("eIep"),o("cH1L");var Pt=function(){function t(e,i){r(this,t),this._document=e,this._viewportRuler=i,this.positions=new Map}return s(t,[{key:"clear",value:function(){this.positions.clear()}},{key:"cache",value:function(t){var e=this;this.clear(),this.positions.set(this._document,{scrollPosition:this._viewportRuler.getViewportScrollPosition()}),t.forEach((function(t){e.positions.set(t,{scrollPosition:{top:t.scrollTop,left:t.scrollLeft},clientRect:yt(t)})}))}},{key:"handleScroll",value:function(t){var e=t.target,i=this.positions.get(e);if(!i)return null;var n,r,o=e===this._document?e.documentElement:e,s=i.scrollPosition;if(e===this._document){var a=this._viewportRuler.getViewportScrollPosition();n=a.top,r=a.left}else n=e.scrollTop,r=e.scrollLeft;var c=s.top-n,l=s.left-r;return this.positions.forEach((function(t,i){t.clientRect&&e!==i&&o.contains(i)&&Dt(t.clientRect,c,l)})),s.top=n,s.left=r,{top:c,left:l}}}]),t}();function kt(t){var e=t.cloneNode(!0),i=e.querySelectorAll("[id]"),n=t.nodeName.toLowerCase();e.removeAttribute("id");for(var r=0;r<i.length;r++)i[r].removeAttribute("id");return"canvas"===n?Rt(t,e):"input"!==n&&"select"!==n&&"textarea"!==n||Ct(t,e),Et("canvas",t,e,Rt),Et("input, textarea, select",t,e,Ct),e}function Et(t,e,i,n){var r=e.querySelectorAll(t);if(r.length)for(var o=i.querySelectorAll(t),s=0;s<r.length;s++)n(r[s],o[s])}var xt=0;function Ct(t,e){e.value=t.value,"radio"===e.type&&e.name&&(e.name="mat-clone-".concat(e.name,"-").concat(xt++))}function Rt(t,e){var i=e.getContext("2d");if(i)try{i.drawImage(t,0,0)}catch(n){}}var Tt=Object(at.f)({passive:!0}),Ot=Object(at.f)({passive:!1}),It=function(){function t(e,i,n,o,s,a){var c=this;r(this,t),this._config=i,this._document=n,this._ngZone=o,this._viewportRuler=s,this._dragDropRegistry=a,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._moveEvents=new lt.a,this._pointerMoveSubscription=f.a.EMPTY,this._pointerUpSubscription=f.a.EMPTY,this._scrollSubscription=f.a.EMPTY,this._resizeSubscription=f.a.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this._disabled=!1,this.beforeStarted=new lt.a,this.started=new lt.a,this.released=new lt.a,this.ended=new lt.a,this.entered=new lt.a,this.exited=new lt.a,this.dropped=new lt.a,this.moved=this._moveEvents,this._pointerDown=function(t){if(c.beforeStarted.next(),c._handles.length){var e=c._handles.find((function(e){var i=t.target;return!!i&&(i===e||e.contains(i))}));!e||c._disabledHandles.has(e)||c.disabled||c._initializeDragSequence(e,t)}else c.disabled||c._initializeDragSequence(c._rootElement,t)},this._pointerMove=function(t){t.preventDefault();var e=c._getPointerPositionOnPage(t);if(c._hasStartedDragging){c._boundaryElement&&(c._previewRect&&(c._previewRect.width||c._previewRect.height)||(c._previewRect=(c._preview||c._rootElement).getBoundingClientRect()));var i=c._getConstrainedPointerPosition(e);if(c._hasMoved=!0,c._lastKnownPointerPosition=e,c._updatePointerDirectionDelta(i),c._dropContainer)c._updateActiveDropContainer(i,e);else{var n=c._activeTransform;n.x=i.x-c._pickupPositionOnPage.x+c._passiveTransform.x,n.y=i.y-c._pickupPositionOnPage.y+c._passiveTransform.y,c._applyRootElementTransform(n.x,n.y),"undefined"!=typeof SVGElement&&c._rootElement instanceof SVGElement&&c._rootElement.setAttribute("transform","translate(".concat(n.x," ").concat(n.y,")"))}c._moveEvents.observers.length&&c._ngZone.run((function(){c._moveEvents.next({source:c,pointerPosition:i,event:t,distance:c._getDragDistance(i),delta:c._pointerDirectionDelta})}))}else if(Math.abs(e.x-c._pickupPositionOnPage.x)+Math.abs(e.y-c._pickupPositionOnPage.y)>=c._config.dragStartThreshold){if(!(Date.now()>=c._dragStartTime+c._getDragStartDelay(t)))return void c._endDragSequence(t);c._dropContainer&&c._dropContainer.isDragging()||(c._hasStartedDragging=!0,c._ngZone.run((function(){return c._startDragSequence(t)})))}},this._pointerUp=function(t){c._endDragSequence(t)},this.withRootElement(e),this._parentPositions=new Pt(n,s),a.registerDragItem(this)}return s(t,[{key:"getPlaceholderElement",value:function(){return this._placeholder}},{key:"getRootElement",value:function(){return this._rootElement}},{key:"getVisibleElement",value:function(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}},{key:"withHandles",value:function(t){return this._handles=t.map((function(t){return Object(ct.e)(t)})),this._handles.forEach((function(t){return gt(t,!1)})),this._toggleNativeDragInteractions(),this}},{key:"withPreviewTemplate",value:function(t){return this._previewTemplate=t,this}},{key:"withPlaceholderTemplate",value:function(t){return this._placeholderTemplate=t,this}},{key:"withRootElement",value:function(t){var e=this,i=Object(ct.e)(t);return i!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular((function(){i.addEventListener("mousedown",e._pointerDown,Ot),i.addEventListener("touchstart",e._pointerDown,Tt)})),this._initialTransform=void 0,this._rootElement=i),"undefined"!=typeof SVGElement&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}},{key:"withBoundaryElement",value:function(t){var e=this;return this._boundaryElement=t?Object(ct.e)(t):null,this._resizeSubscription.unsubscribe(),t&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe((function(){return e._containInsideBoundaryOnResize()}))),this}},{key:"dispose",value:function(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&Nt(this._rootElement),Nt(this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeSubscriptions(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=null}},{key:"isDragging",value:function(){return this._hasStartedDragging&&this._dragDropRegistry.isDragging(this)}},{key:"reset",value:function(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}},{key:"disableHandle",value:function(t){this._handles.indexOf(t)>-1&&this._disabledHandles.add(t)}},{key:"enableHandle",value:function(t){this._disabledHandles.delete(t)}},{key:"withDirection",value:function(t){return this._direction=t,this}},{key:"_withDropContainer",value:function(t){this._dropContainer=t}},{key:"getFreeDragPosition",value:function(){var t=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:t.x,y:t.y}}},{key:"setFreeDragPosition",value:function(t){return this._activeTransform={x:0,y:0},this._passiveTransform.x=t.x,this._passiveTransform.y=t.y,this._dropContainer||this._applyRootElementTransform(t.x,t.y),this}},{key:"_sortFromLastPointerPosition",value:function(){var t=this._lastKnownPointerPosition;t&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(t),t)}},{key:"_removeSubscriptions",value:function(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe()}},{key:"_destroyPreview",value:function(){this._preview&&Nt(this._preview),this._previewRef&&this._previewRef.destroy(),this._preview=this._previewRef=null}},{key:"_destroyPlaceholder",value:function(){this._placeholder&&Nt(this._placeholder),this._placeholderRef&&this._placeholderRef.destroy(),this._placeholder=this._placeholderRef=null}},{key:"_endDragSequence",value:function(t){var e=this;this._dragDropRegistry.isDragging(this)&&(this._removeSubscriptions(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging&&(this.released.next({source:this}),this._dropContainer?(this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then((function(){e._cleanupDragArtifacts(t),e._cleanupCachedDimensions(),e._dragDropRegistry.stopDragging(e)}))):(this._passiveTransform.x=this._activeTransform.x,this._passiveTransform.y=this._activeTransform.y,this._ngZone.run((function(){e.ended.next({source:e,distance:e._getDragDistance(e._getPointerPositionOnPage(t))})})),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this))))}},{key:"_startDragSequence",value:function(t){jt(t)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();var e,i=this._dropContainer;if(i){var n=this._rootElement,r=n.parentNode,o=this._preview=this._createPreviewElement(),s=this._placeholder=this._createPlaceholderElement(),a=this._anchor=this._anchor||this._document.createComment("");r.insertBefore(a,n),n.style.display="none",this._document.body.appendChild(r.replaceChild(s,n)),(e=this._document,e.fullscreenElement||e.webkitFullscreenElement||e.mozFullScreenElement||e.msFullscreenElement||e.body).appendChild(o),this.started.next({source:this}),i.start(),this._initialContainer=i,this._initialIndex=i.getItemIndex(this)}else this.started.next({source:this}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(i?i.getScrollableParents():[])}},{key:"_initializeDragSequence",value:function(t,e){var i=this;e.stopPropagation();var n=this.isDragging(),r=jt(e),o=!r&&0!==e.button,s=this._rootElement,a=!r&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now();if(e.target&&e.target.draggable&&"mousedown"===e.type&&e.preventDefault(),!(n||o||a)){this._handles.length&&(this._rootElementTapHighlight=s.style.webkitTapHighlightColor||"",s.style.webkitTapHighlightColor="transparent"),this._hasStartedDragging=this._hasMoved=!1,this._removeSubscriptions(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scroll.subscribe((function(t){i._updateOnScroll(t)})),this._boundaryElement&&(this._boundaryRect=yt(this._boundaryElement));var c=this._previewTemplate;this._pickupPositionInElement=c&&c.template&&!c.matchSize?{x:0,y:0}:this._getPointerPositionInElement(t,e);var l=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(e);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:l.x,y:l.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,e)}}},{key:"_cleanupDragArtifacts",value:function(t){var e=this;this._rootElement.style.display="",this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._boundaryRect=this._previewRect=void 0,this._ngZone.run((function(){var i=e._dropContainer,n=i.getItemIndex(e),r=e._getPointerPositionOnPage(t),o=e._getDragDistance(e._getPointerPositionOnPage(t)),s=i._isOverContainer(r.x,r.y);e.ended.next({source:e,distance:o}),e.dropped.next({item:e,currentIndex:n,previousIndex:e._initialIndex,container:i,previousContainer:e._initialContainer,isPointerOverContainer:s,distance:o}),i.drop(e,n,e._initialContainer,s,o,e._initialIndex),e._dropContainer=e._initialContainer}))}},{key:"_updateActiveDropContainer",value:function(t,e){var i=this,n=t.x,r=t.y,o=e.x,s=e.y,a=this._initialContainer._getSiblingContainerFromPosition(this,n,r);!a&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(n,r)&&(a=this._initialContainer),a&&a!==this._dropContainer&&this._ngZone.run((function(){i.exited.next({item:i,container:i._dropContainer}),i._dropContainer.exit(i),i._dropContainer=a,i._dropContainer.enter(i,n,r,a===i._initialContainer&&a.sortingDisabled?i._initialIndex:void 0),i.entered.next({item:i,container:a,currentIndex:a.getItemIndex(i)})})),this._dropContainer._startScrollingIfNecessary(o,s),this._dropContainer._sortItem(this,n,r,this._pointerDirectionDelta),this._preview.style.transform=Bt(n-this._pickupPositionInElement.x,r-this._pickupPositionInElement.y)}},{key:"_createPreviewElement",value:function(){var t,e=this._previewTemplate,i=this.previewClass,n=e?e.template:null;if(n&&e){var r=e.matchSize?this._rootElement.getBoundingClientRect():null,o=e.viewContainer.createEmbeddedView(n,e.context);o.detectChanges(),t=At(o,this._document),this._previewRef=o,e.matchSize?Lt(t,r):t.style.transform=Bt(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else{var s=this._rootElement;Lt(t=kt(s),s.getBoundingClientRect())}return _t(t.style,{pointerEvents:"none",margin:"0",position:"fixed",top:"0",left:"0",zIndex:""+(this._config.zIndex||1e3)}),gt(t,!1),t.classList.add("cdk-drag-preview"),t.setAttribute("dir",this._direction),i&&(Array.isArray(i)?i.forEach((function(e){return t.classList.add(e)})):t.classList.add(i)),t}},{key:"_animatePreviewToPlaceholder",value:function(){var t=this;if(!this._hasMoved)return Promise.resolve();var e=this._placeholder.getBoundingClientRect();this._preview.classList.add("cdk-drag-animating"),this._preview.style.transform=Bt(e.left,e.top);var i=function(t){var e=getComputedStyle(t),i=bt(e,"transition-property"),n=i.find((function(t){return"transform"===t||"all"===t}));if(!n)return 0;var r=i.indexOf(n),o=bt(e,"transition-duration"),s=bt(e,"transition-delay");return vt(o[r])+vt(s[r])}(this._preview);return 0===i?Promise.resolve():this._ngZone.runOutsideAngular((function(){return new Promise((function(e){var n=function i(n){(!n||n.target===t._preview&&"transform"===n.propertyName)&&(t._preview.removeEventListener("transitionend",i),e(),clearTimeout(r))},r=setTimeout(n,1.5*i);t._preview.addEventListener("transitionend",n)}))}))}},{key:"_createPlaceholderElement",value:function(){var t,e=this._placeholderTemplate,i=e?e.template:null;return i?(this._placeholderRef=e.viewContainer.createEmbeddedView(i,e.context),this._placeholderRef.detectChanges(),t=At(this._placeholderRef,this._document)):t=kt(this._rootElement),t.classList.add("cdk-drag-placeholder"),t}},{key:"_getPointerPositionInElement",value:function(t,e){var i=this._rootElement.getBoundingClientRect(),n=t===this._rootElement?null:t,r=n?n.getBoundingClientRect():i,o=jt(e)?e.targetTouches[0]:e,s=this._getViewportScrollPosition();return{x:r.left-i.left+(o.pageX-r.left-s.left),y:r.top-i.top+(o.pageY-r.top-s.top)}}},{key:"_getPointerPositionOnPage",value:function(t){var e=this._getViewportScrollPosition(),i=jt(t)?t.touches[0]||t.changedTouches[0]||{pageX:0,pageY:0}:t,n=i.pageX-e.left,r=i.pageY-e.top;if(this._ownerSVGElement){var o=this._ownerSVGElement.getScreenCTM();if(o){var s=this._ownerSVGElement.createSVGPoint();return s.x=n,s.y=r,s.matrixTransform(o.inverse())}}return{x:n,y:r}}},{key:"_getConstrainedPointerPosition",value:function(t){var e=this._dropContainer?this._dropContainer.lockAxis:null,i=this.constrainPosition?this.constrainPosition(t,this):t,n=i.x,r=i.y;if("x"===this.lockAxis||"x"===e?r=this._pickupPositionOnPage.y:"y"!==this.lockAxis&&"y"!==e||(n=this._pickupPositionOnPage.x),this._boundaryRect){var o=this._pickupPositionInElement,s=o.x,a=o.y,c=this._boundaryRect,l=this._previewRect,h=c.top+a,u=c.bottom-(l.height-a);n=Mt(n,c.left+s,c.right-(l.width-s)),r=Mt(r,h,u)}return{x:n,y:r}}},{key:"_updatePointerDirectionDelta",value:function(t){var e=t.x,i=t.y,n=this._pointerDirectionDelta,r=this._pointerPositionAtLastDirectionChange,o=Math.abs(e-r.x),s=Math.abs(i-r.y);return o>this._config.pointerDirectionChangeThreshold&&(n.x=e>r.x?1:-1,r.x=e),s>this._config.pointerDirectionChangeThreshold&&(n.y=i>r.y?1:-1,r.y=i),n}},{key:"_toggleNativeDragInteractions",value:function(){if(this._rootElement&&this._handles){var t=this._handles.length>0||!this.isDragging();t!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=t,gt(this._rootElement,t))}}},{key:"_removeRootElementListeners",value:function(t){t.removeEventListener("mousedown",this._pointerDown,Ot),t.removeEventListener("touchstart",this._pointerDown,Tt)}},{key:"_applyRootElementTransform",value:function(t,e){var i=Bt(t,e);null==this._initialTransform&&(this._initialTransform=this._rootElement.style.transform||""),this._rootElement.style.transform=this._initialTransform?i+" "+this._initialTransform:i}},{key:"_getDragDistance",value:function(t){var e=this._pickupPositionOnPage;return e?{x:t.x-e.x,y:t.y-e.y}:{x:0,y:0}}},{key:"_cleanupCachedDimensions",value:function(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}},{key:"_containInsideBoundaryOnResize",value:function(){var t=this._passiveTransform,e=t.x,i=t.y;if(!(0===e&&0===i||this.isDragging())&&this._boundaryElement){var n=this._boundaryElement.getBoundingClientRect(),r=this._rootElement.getBoundingClientRect();if(!(0===n.width&&0===n.height||0===r.width&&0===r.height)){var o=n.left-r.left,s=r.right-n.right,a=n.top-r.top,c=r.bottom-n.bottom;n.width>r.width?(o>0&&(e+=o),s>0&&(e-=s)):e=0,n.height>r.height?(a>0&&(i+=a),c>0&&(i-=c)):i=0,e===this._passiveTransform.x&&i===this._passiveTransform.y||this.setFreeDragPosition({y:i,x:e})}}}},{key:"_getDragStartDelay",value:function(t){var e=this.dragStartDelay;return"number"==typeof e?e:jt(t)?e.touch:e?e.mouse:0}},{key:"_updateOnScroll",value:function(t){var e=this._parentPositions.handleScroll(t);if(e){var i=t.target;this._boundaryRect&&(i===this._document||i!==this._boundaryElement&&i.contains(this._boundaryElement))&&Dt(this._boundaryRect,e.top,e.left),this._pickupPositionOnPage.x+=e.left,this._pickupPositionOnPage.y+=e.top,this._dropContainer||(this._activeTransform.x-=e.left,this._activeTransform.y-=e.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}},{key:"_getViewportScrollPosition",value:function(){var t=this._parentPositions.positions.get(this._document);return t?t.scrollPosition:this._viewportRuler.getViewportScrollPosition()}},{key:"disabled",get:function(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)},set:function(t){var e=Object(ct.c)(t);e!==this._disabled&&(this._disabled=e,this._toggleNativeDragInteractions())}}]),t}();function Bt(t,e){return"translate3d(".concat(Math.round(t),"px, ").concat(Math.round(e),"px, 0)")}function Mt(t,e,i){return Math.max(e,Math.min(i,t))}function Nt(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function jt(t){return"t"===t.type[0]}function At(t,e){var i=t.rootNodes;if(1===i.length&&i[0].nodeType===e.ELEMENT_NODE)return i[0];var n=e.createElement("div");return i.forEach((function(t){return n.appendChild(t)})),n}function Lt(t,e){t.style.width=e.width+"px",t.style.height=e.height+"px",t.style.transform=Bt(e.left,e.top)}function Gt(t,e){return Math.max(0,Math.min(e,t))}var Ft=function(){function i(t,e,n,o,s){var a=this;r(this,i),this._dragDropRegistry=e,this._ngZone=o,this._viewportRuler=s,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.enterPredicate=function(){return!0},this.beforeStarted=new lt.a,this.entered=new lt.a,this.exited=new lt.a,this.dropped=new lt.a,this.sorted=new lt.a,this._isDragging=!1,this._itemPositions=[],this._previousSwap={drag:null,delta:0,overlaps:!1},this._siblings=[],this._orientation="vertical",this._activeSiblings=new Set,this._direction="ltr",this._viewportScrollSubscription=f.a.EMPTY,this._verticalScrollDirection=0,this._horizontalScrollDirection=0,this._stopScrollTimers=new lt.a,this._cachedShadowRoot=null,this._startScrollInterval=function(){a._stopScrolling(),function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ut.a;return(!Object(dt.a)(t)||t<0)&&(t=0),e&&"function"==typeof e.schedule||(e=ut.a),new ht.a((function(i){return i.add(e.schedule(pt,t,{subscriber:i,counter:0,period:t})),i}))}(0,ft.a).pipe(Object(mt.a)(a._stopScrollTimers)).subscribe((function(){var t=a._scrollNode;1===a._verticalScrollDirection?Ht(t,-2):2===a._verticalScrollDirection&&Ht(t,2),1===a._horizontalScrollDirection?Vt(t,-2):2===a._horizontalScrollDirection&&Vt(t,2)}))},this.element=Object(ct.e)(t),this._document=n,this.withScrollableParents([this.element]),e.registerDropContainer(this),this._parentPositions=new Pt(n,s)}return s(i,[{key:"dispose",value:function(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}},{key:"isDragging",value:function(){return this._isDragging}},{key:"start",value:function(){var t=this,e=Object(ct.e)(this.element).style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=e.msScrollSnapType||e.scrollSnapType||"",e.scrollSnapType=e.msScrollSnapType="none",this._cacheItems(),this._siblings.forEach((function(e){return e._startReceiving(t)})),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}},{key:"enter",value:function(t,e,i,n){var r;this.start(),null==n?-1===(r=this.sortingDisabled?this._draggables.indexOf(t):-1)&&(r=this._getItemIndexFromPointerPosition(t,e,i)):r=n;var o=this._activeDraggables,s=o.indexOf(t),a=t.getPlaceholderElement(),c=o[r];if(c===t&&(c=o[r+1]),s>-1&&o.splice(s,1),c&&!this._dragDropRegistry.isDragging(c)){var l=c.getRootElement();l.parentElement.insertBefore(a,l),o.splice(r,0,t)}else if(this._shouldEnterAsFirstChild(e,i)){var h=o[0].getRootElement();h.parentNode.insertBefore(a,h),o.unshift(t)}else Object(ct.e)(this.element).appendChild(a),o.push(t);a.style.transform="",this._cacheItemPositions(),this._cacheParentPositions(),this.entered.next({item:t,container:this,currentIndex:this.getItemIndex(t)})}},{key:"exit",value:function(t){this._reset(),this.exited.next({item:t,container:this})}},{key:"drop",value:function(t,e,i,n,r,o){this._reset(),null==o&&(o=i.getItemIndex(t)),this.dropped.next({item:t,currentIndex:e,previousIndex:o,container:this,previousContainer:i,isPointerOverContainer:n,distance:r})}},{key:"withItems",value:function(t){var e=this,i=this._draggables;return this._draggables=t,t.forEach((function(t){return t._withDropContainer(e)})),this.isDragging()&&(i.filter((function(t){return t.isDragging()})).every((function(e){return-1===t.indexOf(e)}))?this._reset():this._cacheItems()),this}},{key:"withDirection",value:function(t){return this._direction=t,this}},{key:"connectedTo",value:function(t){return this._siblings=t.slice(),this}},{key:"withOrientation",value:function(t){return this._orientation=t,this}},{key:"withScrollableParents",value:function(t){var i=Object(ct.e)(this.element);return this._scrollableElements=-1===t.indexOf(i)?[i].concat(e(t)):t.slice(),this}},{key:"getScrollableParents",value:function(){return this._scrollableElements}},{key:"getItemIndex",value:function(t){return this._isDragging?zt("horizontal"===this._orientation&&"rtl"===this._direction?this._itemPositions.slice().reverse():this._itemPositions,(function(e){return e.drag===t})):this._draggables.indexOf(t)}},{key:"isReceiving",value:function(){return this._activeSiblings.size>0}},{key:"_sortItem",value:function(t,e,i,n){if(!this.sortingDisabled&&wt(this._clientRect,.05,e,i)){var r=this._itemPositions,o=this._getItemIndexFromPointerPosition(t,e,i,n);if(!(-1===o&&r.length>0)){var s="horizontal"===this._orientation,a=zt(r,(function(e){return e.drag===t})),c=r[o],l=c.clientRect,h=a>o?1:-1,u=this._getItemOffsetPx(r[a].clientRect,l,h),d=this._getSiblingOffsetPx(a,r,h),p=r.slice();!function(t,e,i){var n=Gt(e,t.length-1),r=Gt(i,t.length-1);if(n!==r){for(var o=t[n],s=r<n?-1:1,a=n;a!==r;a+=s)t[a]=t[a+s];t[r]=o}}(r,a,o),this.sorted.next({previousIndex:a,currentIndex:o,container:this,item:t}),r.forEach((function(e,i){if(p[i]!==e){var n=e.drag===t,r=n?u:d,o=n?t.getPlaceholderElement():e.drag.getRootElement();e.offset+=r,s?(o.style.transform="translate3d(".concat(Math.round(e.offset),"px, 0, 0)"),Dt(e.clientRect,0,r)):(o.style.transform="translate3d(0, ".concat(Math.round(e.offset),"px, 0)"),Dt(e.clientRect,r,0))}})),this._previousSwap.overlaps=St(l,e,i),this._previousSwap.drag=c.drag,this._previousSwap.delta=s?n.x:n.y}}}},{key:"_startScrollingIfNecessary",value:function(e,i){var n=this;if(!this.autoScrollDisabled){var r,o=0,s=0;if(this._parentPositions.positions.forEach((function(a,c){var l;c!==n._document&&a.clientRect&&!r&&wt(a.clientRect,.05,e,i)&&(l=t(function(t,e,i,n){var r=Ut(e,n),o=Xt(e,i),s=0,a=0;if(r){var c=t.scrollTop;1===r?c>0&&(s=1):t.scrollHeight-c>t.clientHeight&&(s=2)}if(o){var l=t.scrollLeft;1===o?l>0&&(a=1):t.scrollWidth-l>t.clientWidth&&(a=2)}return[s,a]}(c,a.clientRect,e,i),2),o=l[0],s=l[1],(o||s)&&(r=c))})),!o&&!s){var a=this._viewportRuler.getViewportSize(),c=a.width,l=a.height,h={width:c,height:l,top:0,right:c,bottom:l,left:0};o=Ut(h,i),s=Xt(h,e),r=window}!r||o===this._verticalScrollDirection&&s===this._horizontalScrollDirection&&r===this._scrollNode||(this._verticalScrollDirection=o,this._horizontalScrollDirection=s,this._scrollNode=r,(o||s)&&r?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}}},{key:"_stopScrolling",value:function(){this._stopScrollTimers.next()}},{key:"_cacheParentPositions",value:function(){var t=Object(ct.e)(this.element);this._parentPositions.cache(this._scrollableElements),this._clientRect=this._parentPositions.positions.get(t).clientRect}},{key:"_cacheItemPositions",value:function(){var t="horizontal"===this._orientation;this._itemPositions=this._activeDraggables.map((function(t){var e=t.getVisibleElement();return{drag:t,offset:0,clientRect:yt(e)}})).sort((function(e,i){return t?e.clientRect.left-i.clientRect.left:e.clientRect.top-i.clientRect.top}))}},{key:"_reset",value:function(){var t=this;this._isDragging=!1;var e=Object(ct.e)(this.element).style;e.scrollSnapType=e.msScrollSnapType=this._initialScrollSnap,this._activeDraggables.forEach((function(t){var e=t.getRootElement();e&&(e.style.transform="")})),this._siblings.forEach((function(e){return e._stopReceiving(t)})),this._activeDraggables=[],this._itemPositions=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1,this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}},{key:"_getSiblingOffsetPx",value:function(t,e,i){var n="horizontal"===this._orientation,r=e[t].clientRect,o=e[t+-1*i],s=r[n?"width":"height"]*i;if(o){var a=n?"left":"top",c=n?"right":"bottom";-1===i?s-=o.clientRect[a]-r[c]:s+=r[a]-o.clientRect[c]}return s}},{key:"_getItemOffsetPx",value:function(t,e,i){var n="horizontal"===this._orientation,r=n?e.left-t.left:e.top-t.top;return-1===i&&(r+=n?e.width-t.width:e.height-t.height),r}},{key:"_shouldEnterAsFirstChild",value:function(t,e){if(!this._activeDraggables.length)return!1;var i=this._itemPositions,n="horizontal"===this._orientation;if(i[0].drag!==this._activeDraggables[0]){var r=i[i.length-1].clientRect;return n?t>=r.right:e>=r.bottom}var o=i[0].clientRect;return n?t<=o.left:e<=o.top}},{key:"_getItemIndexFromPointerPosition",value:function(t,e,i,n){var r=this,o="horizontal"===this._orientation;return zt(this._itemPositions,(function(s,a,c){var l=s.drag,h=s.clientRect;if(l===t)return c.length<2;if(n){var u=o?n.x:n.y;if(l===r._previousSwap.drag&&r._previousSwap.overlaps&&u===r._previousSwap.delta)return!1}return o?e>=Math.floor(h.left)&&e<Math.floor(h.right):i>=Math.floor(h.top)&&i<Math.floor(h.bottom)}))}},{key:"_cacheItems",value:function(){this._activeDraggables=this._draggables.slice(),this._cacheItemPositions(),this._cacheParentPositions()}},{key:"_isOverContainer",value:function(t,e){return St(this._clientRect,t,e)}},{key:"_getSiblingContainerFromPosition",value:function(t,e,i){return this._siblings.find((function(n){return n._canReceive(t,e,i)}))}},{key:"_canReceive",value:function(t,e,i){if(!St(this._clientRect,e,i)||!this.enterPredicate(t,this))return!1;var n=this._getShadowRoot().elementFromPoint(e,i);if(!n)return!1;var r=Object(ct.e)(this.element);return n===r||r.contains(n)}},{key:"_startReceiving",value:function(t){var e=this._activeSiblings;e.has(t)||(e.add(t),this._cacheParentPositions(),this._listenToScrollEvents())}},{key:"_stopReceiving",value:function(t){this._activeSiblings.delete(t),this._viewportScrollSubscription.unsubscribe()}},{key:"_listenToScrollEvents",value:function(){var t=this;this._viewportScrollSubscription=this._dragDropRegistry.scroll.subscribe((function(e){if(t.isDragging()){var i=t._parentPositions.handleScroll(e);i&&(t._itemPositions.forEach((function(t){Dt(t.clientRect,i.top,i.left)})),t._itemPositions.forEach((function(e){var i=e.drag;t._dragDropRegistry.isDragging(i)&&i._sortFromLastPointerPosition()})))}else t.isReceiving()&&t._cacheParentPositions()}))}},{key:"_getShadowRoot",value:function(){if(!this._cachedShadowRoot){var t=Object(at.c)(Object(ct.e)(this.element));this._cachedShadowRoot=t||this._document}return this._cachedShadowRoot}}]),i}();function zt(t,e){for(var i=0;i<t.length;i++)if(e(t[i],i,t))return i;return-1}function Ht(t,e){t===window?t.scrollBy(0,e):t.scrollTop+=e}function Vt(t,e){t===window?t.scrollBy(e,0):t.scrollLeft+=e}function Ut(t,e){var i=t.top,n=t.bottom,r=.05*t.height;return e>=i-r&&e<=i+r?1:e>=n-r&&e<=n+r?2:0}function Xt(t,e){var i=t.left,n=t.right,r=.05*t.width;return e>=i-r&&e<=i+r?1:e>=n-r&&e<=n+r?2:0}var qt,Zt,Qt,Yt,Wt=Object(at.f)({passive:!1,capture:!0}),Kt=((qt=function(){function t(e,i){var n=this;r(this,t),this._ngZone=e,this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=new Set,this._globalListeners=new Map,this.pointerMove=new lt.a,this.pointerUp=new lt.a,this.scroll=new lt.a,this._preventDefaultWhileDragging=function(t){n._activeDragInstances.size&&t.preventDefault()},this._document=i}return s(t,[{key:"registerDropContainer",value:function(t){this._dropInstances.has(t)||this._dropInstances.add(t)}},{key:"registerDragItem",value:function(t){var e=this;this._dragInstances.add(t),1===this._dragInstances.size&&this._ngZone.runOutsideAngular((function(){e._document.addEventListener("touchmove",e._preventDefaultWhileDragging,Wt)}))}},{key:"removeDropContainer",value:function(t){this._dropInstances.delete(t)}},{key:"removeDragItem",value:function(t){this._dragInstances.delete(t),this.stopDragging(t),0===this._dragInstances.size&&this._document.removeEventListener("touchmove",this._preventDefaultWhileDragging,Wt)}},{key:"startDragging",value:function(t,e){var i=this;if(!this._activeDragInstances.has(t)&&(this._activeDragInstances.add(t),1===this._activeDragInstances.size)){var n=e.type.startsWith("touch"),r=n?"touchend":"mouseup";this._globalListeners.set(n?"touchmove":"mousemove",{handler:function(t){return i.pointerMove.next(t)},options:Wt}).set(r,{handler:function(t){return i.pointerUp.next(t)},options:!0}).set("scroll",{handler:function(t){return i.scroll.next(t)},options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:Wt}),this._ngZone.runOutsideAngular((function(){i._globalListeners.forEach((function(t,e){i._document.addEventListener(e,t.handler,t.options)}))}))}}},{key:"stopDragging",value:function(t){this._activeDragInstances.delete(t),0===this._activeDragInstances.size&&this._clearGlobalListeners()}},{key:"isDragging",value:function(t){return this._activeDragInstances.has(t)}},{key:"ngOnDestroy",value:function(){var t=this;this._dragInstances.forEach((function(e){return t.removeDragItem(e)})),this._dropInstances.forEach((function(e){return t.removeDropContainer(e)})),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}},{key:"_clearGlobalListeners",value:function(){var t=this;this._globalListeners.forEach((function(e,i){t._document.removeEventListener(i,e.handler,e.options)})),this._globalListeners.clear()}}]),t}()).\u0275fac=function(t){return new(t||qt)(m.Xb(m.B),m.Xb(a.d))},qt.\u0275prov=Object(m.Jb)({factory:function(){return new qt(Object(m.Xb)(m.B),Object(m.Xb)(a.d))},token:qt,providedIn:"root"}),qt),Jt={dragStartThreshold:5,pointerDirectionChangeThreshold:5},$t=((Qt=function(){function t(e,i,n,o){r(this,t),this._document=e,this._ngZone=i,this._viewportRuler=n,this._dragDropRegistry=o}return s(t,[{key:"createDrag",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jt;return new It(t,e,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}},{key:"createDropList",value:function(t){return new Ft(t,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}}]),t}()).\u0275fac=function(t){return new(t||Qt)(m.Xb(a.d),m.Xb(m.B),m.Xb(st.e),m.Xb(Kt))},Qt.\u0275prov=Object(m.Jb)({factory:function(){return new Qt(Object(m.Xb)(a.d),Object(m.Xb)(m.B),Object(m.Xb)(st.e),Object(m.Xb)(Kt))},token:Qt,providedIn:"root"}),Qt),te=((Zt=function t(){r(this,t)}).\u0275mod=m.Lb({type:Zt}),Zt.\u0275inj=m.Kb({factory:function(t){return new(t||Zt)},providers:[$t],imports:[st.b]}),Zt),ee=o("f6nW"),ie=((Yt=function t(){r(this,t)}).\u0275mod=m.Lb({type:Yt}),Yt.\u0275inj=m.Kb({factory:function(t){return new(t||Yt)},imports:[[a.c,c.b,h.m,h.w,b.c,v.d,D.b,S.b,g.b,ot.b,rt.b,y.c,P.k,w.d,u.p,te,ee.r,nt]]}),Yt)}}])}();