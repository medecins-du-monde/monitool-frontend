(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{"5ncX":function(t,e,n){"use strict";n.r(e),n.d(e,"InputsModule",(function(){return _}));var i=n("ofXK"),a=n("tyNb"),o=n("mrSG"),s=n("quSY"),c=n("RtbK"),r=n.n(c),u=n("IXMC"),l=n("fXoL"),m=n("c3AT"),d=n("sYmb"),b=n("wLEN"),f=n("bTqV"),h=n("NFeN"),p=n("+0xr");function g(t,e){if(1&t&&(l.Tb(0,"span"),l.Dc(1),l.Sb()),2&t){const t=l.ec();l.Bb(1),l.Fc('"',t.form.name,'"')}}function D(t,e){if(1&t&&(l.Tb(0,"th",14),l.Dc(1),l.fc(2,"translate"),l.Sb()),2&t){const t=l.ec().$implicit;l.Bb(1),l.Ec(l.gc(2,1,t))}}function v(t,e){if(1&t&&(l.Tb(0,"div"),l.Dc(1),l.Sb()),2&t){const t=l.ec().$implicit,e=l.ec().$implicit;l.Bb(1),l.Ec(t[e])}}function S(t,e){if(1&t&&(l.Tb(0,"div"),l.Tb(1,"button",19),l.Dc(2),l.fc(3,"translate"),l.Sb(),l.Sb()),2&t){const t=l.ec(2).$implicit,e=l.ec().$implicit;l.Bb(1),l.kc("routerLink",t[e].routerLink),l.Bb(1),l.Ec(l.gc(3,2,"Create"))}}function C(t,e){if(1&t&&(l.Tb(0,"button",20),l.Dc(1),l.fc(2,"translate"),l.Sb()),2&t){const t=l.ec(2).$implicit,e=l.ec().$implicit;l.kc("routerLink",t[e].routerLink),l.Bb(1),l.Gc("",l.gc(2,3,"Edit")," (",t[e].value,"%)")}}function $(t,e){if(1&t&&(l.Bc(0,S,4,4,"div",16),l.Bc(1,C,3,5,"ng-template",null,18,l.Cc)),2&t){const t=l.qc(2),e=l.ec().$implicit,n=l.ec().$implicit;l.kc("ngIf",-1===e[n].value)("ngIfElse",t)}}function k(t,e){if(1&t&&(l.Tb(0,"td",15),l.Bc(1,v,2,1,"div",16),l.Bc(2,$,3,2,"ng-template",null,17,l.Cc),l.Sb()),2&t){const t=l.qc(3),e=l.ec().$implicit;l.lc("id",e),l.Bb(1),l.kc("ngIf","Date"===e)("ngIfElse",t)}}function B(t,e){1&t&&(l.Rb(0,11),l.Bc(1,D,3,3,"th",12),l.Bc(2,k,4,3,"td",13),l.Qb()),2&t&&l.lc("matColumnDef",e.$implicit)}function w(t,e){if(1&t){const t=l.Ub();l.Tb(0,"button",23),l.ac("click",(function(){return l.sc(t),l.ec(2).seeOlderDates()})),l.Dc(1),l.fc(2,"translate"),l.Sb()}2&t&&(l.Bb(1),l.Ec(l.gc(2,1,"SeeOlderDates")))}function O(t,e){if(1&t&&(l.Tb(0,"td",21),l.Bc(1,w,3,3,"ng-template",22),l.Sb()),2&t){const t=l.ec();l.Cb("colspan",t.displayedColumns.length),l.Bb(1),l.kc("ngIf",t.seeOlderDatesFlag)}}function I(t,e){1&t&&l.Ob(0,"tr",24)}function L(t,e){1&t&&l.Ob(0,"tr",25)}function P(t,e){1&t&&l.Ob(0,"tr",26)}const T=function(){return["expandedDates"]},y=[{path:"**",component:(()=>{class t{constructor(t,e,n,i,a){this.route=t,this.projectService=e,this.translateService=n,this.datepipe=i,this.inputService=a,this.displayedColumns=[],this.dataSource=[],this.seeOlderDatesFlag=!0,this.sites=[],this.subscription=new s.a}ngOnInit(){this.subscription.add(this.projectService.openedProject.subscribe(t=>{this.project=t,this.updateData()})),this.subscription.add(this.route.params.subscribe(t=>{this.formId=t.formId,this.updateData()}))}get currentLang(){return this.translateService.currentLang?this.translateService.currentLang:this.translateService.defaultLang}updateData(){return Object(o.a)(this,void 0,void 0,(function*(){if(this.formId&&this.project&&(this.form=this.project.forms.find(t=>t.id===this.formId),this.sites=this.form?this.form.entities:[],this.displayedColumns=["Date"].concat(this.sites.map(t=>t.name))),this.thisYearDates=[],this.allDates=[],this.form){let t=new Date;t>this.form.end&&(t=this.form.end);const e=t.getFullYear().toString();let n=r.a.fromDate(t,u.a[this.form.periodicity]);const i=r.a.fromDate(this.form.start,u.a[this.form.periodicity]);if(n===i)this.thisYearDates=[{humanValue:n.humanizeValue(this.currentLang),value:n.value}],this.allDates=[{humanValue:n.humanizeValue(this.currentLang),value:n.value}];else{for(;n!==i;)e===n.value.slice(0,4)&&this.thisYearDates.push({humanValue:n.humanizeValue(this.currentLang),value:n.value}),this.allDates.push({humanValue:n.humanizeValue(this.currentLang),value:n.value}),n=n.previous();e===n.value.slice(0,4)&&this.thisYearDates.push({humanValue:n.humanizeValue(this.currentLang),value:n.value}),this.allDates.push({humanValue:n.humanizeValue(this.currentLang),value:n.value})}}if(this.project&&this.form){this.inputProgress=yield this.inputService.list(this.project.id,this.formId);const t=`input:${this.project.id}:${this.formId}`,e=[];for(const n of this.thisYearDates){const i={Date:n.humanValue};for(const e of this.sites)i[e.name]=`${t}:${e.id}:${n.value}`in this.inputProgress?{value:100*this.inputProgress[`${t}:${e.id}:${n.value}`],routerLink:`./edit/${e.id}/${n.value}`}:{value:-1,routerLink:`./edit/${e.id}/${n.value}`};e.push(i)}this.dataSource=e}}))}seeOlderDates(){const t=`input:${this.project.id}:${this.formId}`,e=[];for(const n of this.allDates){const i={Date:n.humanValue};for(const e of this.sites)i[e.name]=`${t}:${e.id}:${n.value}`in this.inputProgress?{value:100*this.inputProgress[`${t}:${e.id}:${n.value}`],routerLink:`./edit/${e.id}/${n.value}`}:{value:-1,routerLink:`./edit/${e.id}/${n.value}`};e.push(i)}this.dataSource=e,this.seeOlderDatesFlag=!1}ngOnDestroy(){this.subscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(l.Nb(a.a),l.Nb(m.a),l.Nb(d.d),l.Nb(i.e),l.Nb(b.a))},t.\u0275cmp=l.Hb({type:t,selectors:[["app-inputs"]],decls:28,vars:16,consts:[[1,"info-section","blue"],[1,"info-buttons"],["mat-stroked-button","",1,"mdm-button"],[4,"ngIf"],["mat-table","",1,"mdm-table",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","expandedDates"],["mat-footer-cell","","class","expand-row",4,"matFooterCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef"],[3,"matColumnDef"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",3,"id",4,"matCellDef"],["mat-header-cell",""],["mat-cell","",3,"id"],[4,"ngIf","ngIfElse"],["elseBlock",""],["elseBlock2",""],["mat-stroked-button","",1,"mdm-button","small-button","create-button",3,"routerLink"],["mat-stroked-button","",1,"mdm-button","small-button",3,"routerLink"],["mat-footer-cell","",1,"expand-row"],[3,"ngIf"],["mat-stroked-button","",1,"mdm-button","small-button",3,"click"],["mat-header-row",""],["mat-row",""],["mat-footer-row",""]],template:function(t,e){1&t&&(l.Tb(0,"div",0),l.Tb(1,"div",1),l.Tb(2,"button",2),l.Tb(3,"mat-icon"),l.Dc(4,"insert_drive_file"),l.Sb(),l.Dc(5,"Download PDF (portrait)"),l.Sb(),l.Tb(6,"button",2),l.Tb(7,"mat-icon"),l.Dc(8,"note"),l.Sb(),l.Dc(9,"Download PDF (landscape)"),l.Sb(),l.Sb(),l.Tb(10,"span"),l.Tb(11,"p"),l.Dc(12),l.fc(13,"translate"),l.Bc(14,g,2,1,"span",3),l.Sb(),l.Tb(15,"p"),l.Dc(16),l.fc(17,"translate"),l.Sb(),l.Tb(18,"p"),l.Dc(19),l.fc(20,"translate"),l.Sb(),l.Sb(),l.Sb(),l.Tb(21,"table",4),l.Bc(22,B,3,1,"ng-container",5),l.Rb(23,6),l.Bc(24,O,2,2,"td",7),l.Qb(),l.Bc(25,I,1,0,"tr",8),l.Bc(26,L,1,0,"tr",9),l.Bc(27,P,1,0,"tr",10),l.Sb()),2&t&&(l.Bb(12),l.Fc("",l.gc(13,9,"InputsInfo.0")," "),l.Bb(2),l.kc("ngIf",e.form),l.Bb(2),l.Ec(l.gc(17,11,"InputsInfo.1")),l.Bb(3),l.Ec(l.gc(20,13,"InputsInfo.2")),l.Bb(2),l.kc("dataSource",e.dataSource),l.Bb(1),l.kc("ngForOf",e.displayedColumns),l.Bb(3),l.kc("matHeaderRowDef",e.displayedColumns),l.Bb(1),l.kc("matRowDefColumns",e.displayedColumns),l.Bb(1),l.kc("matFooterRowDef",l.nc(15,T)))},directives:[f.a,h.a,i.l,p.n,i.k,p.c,p.e,p.k,p.m,p.g,p.i,p.b,p.h,p.a,a.c,p.d,p.j,p.l,p.f],pipes:[d.c],styles:[".mdm-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .mdm-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:center}.mdm-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{height:100%;padding:4px}.mdm-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:not(.expand-row)   button[_ngcontent-%COMP%]{width:100%}.create-button[_ngcontent-%COMP%]{color:#fff;background-color:#31708f;border-color:#31708f!important}"]}),t})()}];let M=(()=>{class t{}return t.\u0275mod=l.Lb({type:t}),t.\u0275inj=l.Kb({factory:function(e){return new(e||t)},imports:[[a.f.forChild(y)],a.f]}),t})(),_=(()=>{class t{}return t.\u0275mod=l.Lb({type:t}),t.\u0275inj=l.Kb({factory:function(e){return new(e||t)},imports:[[i.c,M,d.b,p.p,f.b,h.b]]}),t})()}}]);