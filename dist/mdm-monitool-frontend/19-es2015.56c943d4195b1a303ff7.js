(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{"D3/3":function(e,t,n){"use strict";var o=Array.isArray,r=Object.keys,a=Object.prototype.hasOwnProperty;e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){var i,s,c,p=o(t),l=o(n);if(p&&l){if((s=t.length)!=n.length)return!1;for(i=s;0!=i--;)if(!e(t[i],n[i]))return!1;return!0}if(p!=l)return!1;var u=t instanceof Date,f=n instanceof Date;if(u!=f)return!1;if(u&&f)return t.getTime()==n.getTime();var d=t instanceof RegExp,h=n instanceof RegExp;if(d!=h)return!1;if(d&&h)return t.toString()==n.toString();var m=r(t);if((s=m.length)!==r(n).length)return!1;for(i=s;0!=i--;)if(!a.call(n,m[i]))return!1;for(i=s;0!=i--;)if(!e(t[c=m[i]],n[c]))return!1;return!0}return t!=t&&n!=n}},LxLq:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var o=n("D3/3"),r=n("YorD");t.JsonPatchError=r.PatchError,t.deepClone=r._deepClone;var a={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var o=e[t];return delete e[t],{newDocument:n,removed:o}},replace:function(e,t,n){var o=e[t];return e[t]=this.value,{newDocument:n,removed:o}},move:function(e,t,n){var o=s(n,this.path);o&&(o=r._deepClone(o));var a=c(n,{op:"remove",path:this.from}).removed;return c(n,{op:"add",path:this.path,value:a}),{newDocument:n,removed:o}},copy:function(e,t,n){var o=s(n,this.from);return c(n,{op:"add",path:this.path,value:r._deepClone(o)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:o(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},i={add:function(e,t,n){return r.isInteger(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){return{newDocument:n,removed:e.splice(t,1)[0]}},replace:function(e,t,n){var o=e[t];return e[t]=this.value,{newDocument:n,removed:o}},move:a.move,copy:a.copy,test:a.test,_get:a._get};function s(e,t){if(""==t)return e;var n={op:"_get",path:t};return c(e,n),n.value}function c(e,n,c,p,l,f){if(void 0===c&&(c=!1),void 0===p&&(p=!0),void 0===l&&(l=!0),void 0===f&&(f=0),c&&("function"==typeof c?c(n,0,e,n.path):u(n,0)),""===n.path){var d={newDocument:e};if("add"===n.op)return d.newDocument=n.value,d;if("replace"===n.op)return d.newDocument=n.value,d.removed=e,d;if("move"===n.op||"copy"===n.op)return d.newDocument=s(e,n.from),"move"===n.op&&(d.removed=e),d;if("test"===n.op){if(d.test=o(e,n.value),!1===d.test)throw new t.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",f,n,e);return d.newDocument=e,d}if("remove"===n.op)return d.removed=e,d.newDocument=null,d;if("_get"===n.op)return n.value=e,d;if(c)throw new t.JsonPatchError("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",f,n,e);return d}p||(e=r._deepClone(e));var h=(n.path||"").split("/"),m=e,v=1,b=h.length,w=void 0,g=void 0,y=void 0;for(y="function"==typeof c?c:u;;){if(g=h[v],l&&"__proto__"==g)throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(c&&void 0===w&&(void 0===m[g]?w=h.slice(0,v).join("/"):v==b-1&&(w=n.path),void 0!==w&&y(n,0,e,w)),v++,Array.isArray(m)){if("-"===g)g=m.length;else{if(c&&!r.isInteger(g))throw new t.JsonPatchError("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",f,n,e);r.isInteger(g)&&(g=~~g)}if(v>=b){if(c&&"add"===n.op&&g>m.length)throw new t.JsonPatchError("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",f,n,e);if(!1===(d=i[n.op].call(n,m,g,e)).test)throw new t.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",f,n,e);return d}}else if(g&&-1!=g.indexOf("~")&&(g=r.unescapePathComponent(g)),v>=b){if(!1===(d=a[n.op].call(n,m,g,e)).test)throw new t.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",f,n,e);return d}m=m[g]}}function p(e,n,o,a,i){if(void 0===a&&(a=!0),void 0===i&&(i=!0),o&&!Array.isArray(n))throw new t.JsonPatchError("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");a||(e=r._deepClone(e));for(var s=new Array(n.length),p=0,l=n.length;p<l;p++)s[p]=c(e,n[p],o,!0,i,p),e=s[p].newDocument;return s.newDocument=e,s}function l(e,n,o){var r=c(e,n);if(!1===r.test)throw new t.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",o,n,e);return r.newDocument}function u(e,n,o,i){if("object"!=typeof e||null===e||Array.isArray(e))throw new t.JsonPatchError("Operation is not an object","OPERATION_NOT_AN_OBJECT",n,e,o);if(!a[e.op])throw new t.JsonPatchError("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",n,e,o);if("string"!=typeof e.path)throw new t.JsonPatchError("Operation `path` property is not a string","OPERATION_PATH_INVALID",n,e,o);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new t.JsonPatchError('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",n,e,o);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new t.JsonPatchError("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",n,e,o);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new t.JsonPatchError("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",n,e,o);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&r.hasUndefined(e.value))throw new t.JsonPatchError("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",n,e,o);if(o)if("add"==e.op){var s=e.path.split("/").length,c=i.split("/").length;if(s!==c+1&&s!==c)throw new t.JsonPatchError("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",n,e,o)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==i)throw new t.JsonPatchError("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",n,e,o)}else if("move"===e.op||"copy"===e.op){var p=f([{op:"_get",path:e.from,value:void 0}],o);if(p&&"OPERATION_PATH_UNRESOLVABLE"===p.name)throw new t.JsonPatchError("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",n,e,o)}}function f(e,n,o){try{if(!Array.isArray(e))throw new t.JsonPatchError("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(n)p(r._deepClone(n),r._deepClone(e),o||!0);else{o=o||u;for(var a=0;a<e.length;a++)o(e[a],a,n,void 0)}}catch(i){if(i instanceof t.JsonPatchError)return i;throw i}}t.getValueByPointer=s,t.applyOperation=c,t.applyPatch=p,t.applyReducer=l,t.validator=u,t.validate=f,t.default={JsonPatchError:t.JsonPatchError,deepClone:t.deepClone,getValueByPointer:s,applyOperation:c,applyPatch:p,applyReducer:l,validator:u,validate:f}},YorD:function(e,t){var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(t,"__esModule",{value:!0});var r=Object.prototype.hasOwnProperty;function a(e,t){return r.call(e,t)}function i(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);for(var o in t=[],e)a(e,o)&&t.push(o);return t}function s(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function c(e,t){var n;for(var o in e)if(a(e,o)){if(e[o]===t)return s(o)+"/";if("object"==typeof e[o]&&""!=(n=c(e[o],t)))return s(o)+"/"+n}return""}function p(e,t){var n=[e];for(var o in t){var r="object"==typeof t[o]?JSON.stringify(t[o],null,2):t[o];void 0!==r&&n.push(o+": "+r)}return n.join("\n")}t.hasOwnProperty=a,t._objectKeys=i,t._deepClone=function(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}},t.isInteger=function(e){for(var t,n=0,o=e.length;n<o;){if(!((t=e.charCodeAt(n))>=48&&t<=57))return!1;n++}return!0},t.escapePathComponent=s,t.unescapePathComponent=function(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")},t._getPathRecursive=c,t.getPath=function(e,t){if(e===t)return"/";var n=c(e,t);if(""===n)throw new Error("Object not found in root");return"/"+n},t.hasUndefined=function e(t){if(void 0===t)return!0;if(t)if(Array.isArray(t)){for(var n=0,o=t.length;n<o;n++)if(e(t[n]))return!0}else if("object"==typeof t){var r=i(t),a=r.length;for(n=0;n<a;n++)if(e(t[r[n]]))return!0}return!1};var l=function(e){function t(t,n,o,r,a){var i=this.constructor,s=e.call(this,p(t,{name:n,index:o,operation:r,tree:a}))||this;return s.name=n,s.index=o,s.operation=r,s.tree=a,Object.setPrototypeOf(s,i.prototype),s.message=p(t,{name:n,index:o,operation:r,tree:a}),s}return o(t,e),t}(Error);t.PatchError=l},gYkR:function(e,t,n){var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=n("YorD"),a=n("LxLq"),i=n("LxLq");t.applyOperation=i.applyOperation,t.applyPatch=i.applyPatch,t.applyReducer=i.applyReducer,t.getValueByPointer=i.getValueByPointer,t.validate=i.validate,t.validator=i.validator;var s=n("YorD");t.JsonPatchError=s.PatchError,t.deepClone=s._deepClone,t.escapePathComponent=s.escapePathComponent,t.unescapePathComponent=s.unescapePathComponent;var c=new WeakMap,p=function(){return function(e){this.observers=new Map,this.obj=e}}(),l=function(){return function(e,t){this.callback=e,this.observer=t}}();function u(e,t){t.unobserve()}function f(e,t){var n,o=function(e){return c.get(e)}(e);if(o){var a=function(e,t){return e.observers.get(t)}(o,t);n=a&&a.observer}else o=new p(e),c.set(e,o);if(n)return n;if(n={},o.value=r._deepClone(e),t){n.callback=t,n.next=null;var i=function(){d(n)},s=function(){clearTimeout(n.next),n.next=setTimeout(i)};"undefined"!=typeof window&&(window.addEventListener("mouseup",s),window.addEventListener("keyup",s),window.addEventListener("mousedown",s),window.addEventListener("keydown",s),window.addEventListener("change",s))}return n.patches=[],n.object=e,n.unobserve=function(){d(n),clearTimeout(n.next),function(e,t){e.observers.delete(t.callback)}(o,n),"undefined"!=typeof window&&(window.removeEventListener("mouseup",s),window.removeEventListener("keyup",s),window.removeEventListener("mousedown",s),window.removeEventListener("keydown",s),window.removeEventListener("change",s))},o.observers.set(t,new l(t,n)),n}function d(e,t){void 0===t&&(t=!1);var n=c.get(e.object);h(n.value,e.object,e.patches,"",t),e.patches.length&&a.applyPatch(n.value,e.patches);var o=e.patches;return o.length>0&&(e.patches=[],e.callback&&e.callback(o)),o}function h(e,t,n,o,a){if(t!==e){"function"==typeof t.toJSON&&(t=t.toJSON());for(var i=r._objectKeys(t),s=r._objectKeys(e),c=!1,p=s.length-1;p>=0;p--){var l=e[f=s[p]];if(!r.hasOwnProperty(t,f)||void 0===t[f]&&void 0!==l&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(a&&n.push({op:"test",path:o+"/"+r.escapePathComponent(f),value:r._deepClone(l)}),n.push({op:"remove",path:o+"/"+r.escapePathComponent(f)}),c=!0):(a&&n.push({op:"test",path:o,value:e}),n.push({op:"replace",path:o,value:t}));else{var u=t[f];"object"==typeof l&&null!=l&&"object"==typeof u&&null!=u?h(l,u,n,o+"/"+r.escapePathComponent(f),a):l!==u&&(a&&n.push({op:"test",path:o+"/"+r.escapePathComponent(f),value:r._deepClone(l)}),n.push({op:"replace",path:o+"/"+r.escapePathComponent(f),value:r._deepClone(u)}))}}if(c||i.length!=s.length)for(p=0;p<i.length;p++){var f;r.hasOwnProperty(e,f=i[p])||void 0===t[f]||n.push({op:"add",path:o+"/"+r.escapePathComponent(f),value:r._deepClone(t[f])})}}}function m(e,t,n){void 0===n&&(n=!1);var o=[];return h(e,t,o,"",n),o}t.unobserve=u,t.observe=f,t.generate=d,t.compare=m;var v=n("LxLq"),b=n("YorD");t.default=o({},v,{unobserve:u,observe:f,generate:d,compare:m,JsonPatchError:b.PatchError,deepClone:r._deepClone,escapePathComponent:r.escapePathComponent,unescapePathComponent:b.unescapePathComponent})},z0vS:function(e,t,n){"use strict";n.r(t),n.d(t,"HistoryModule",(function(){return J}));var o=n("ofXK"),r=n("bTqV"),a=n("NFeN"),i=n("+0xr"),s=n("sYmb"),c=n("tyNb"),p=n("R0Ic"),l=n("O3o7"),u=n("gYkR"),f=n("LvDl"),d=n("iA2r"),h=n("fXoL"),m=n("c3AT");function v(e,t){if(1&e&&(h.Tb(0,"li"),h.Dc(1),h.fc(2,"translate"),h.Sb()),2&e){const e=t.$implicit;h.Bb(1),h.Ec(h.hc(2,1,e.translationKey,e))}}let b=(()=>{class e{constructor(e){this.projectService=e,this.output=[],this.project=null}ngOnInit(){this.projectService.openedProject.subscribe(e=>{this.project=e}),this.createDynamicRevisionText()}createDynamicRevisionText(){let e=this.patchProject(this.index+1),t=this.patchProject(this.index);t=u.applyPatch(t,this.revisions[this.index].backwards).newDocument,t.forms=t.forms.map(e=>new d.a(e)),this.revision.forwards.forEach(n=>{const o=n,r=this.getTranslationKey(o);let a;a=this.getTranslationData(o,0===this.index?t:e,t),r&&(a.translationKey=r,this.output.push(a)),e=u.applyOperation(e,o).newDocument,e.forms=e.forms.map(e=>new d.a(e))})}getTranslationKey(e){let t=e.path.substring(1).replace(/\/\d+\//g,"_").replace(/\/[a-z]+:[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}\//,"_").replace(/\/\d+$/,"").replace(/\/[a-z]+:[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/,"");const n=t.match(/^logicalFrames.*indicators(.*)$/);n&&(t="logicalFrames_indicators"+n[1]);const o=t.match("^(.*)_computation");return o?(t=o[1]+"_computation",t+="_replace"):t=t+"_"+e.op,"HistoryRevision."+t}getTranslationData(e,t,n){const o=e.path.substring(1).replace(/\/\d+\//g,"_").replace(/\/\d+$/,""),r=e.path.split("/").slice(1),a={};let i=t;for(let s=1;s<r.length-1;s+=2){let e=r[s-1];i=i[e][r[s]],e="entities"===e?"entity":"elements"===e&&s<5?"variable":e.substring(0,e.length-1),a[e]=i}return"add"===e.op?a.item=e.value:"replace"===e.op?(a.after=e.value,a.before=t,r.forEach(e=>a.before=a.before[e]),a.before instanceof Date&&(a.before=this.transformDate(a.before))):"remove"===e.op?(a.item=n,r.forEach(e=>a.item=a.item[e])):"move"===e.op&&(a.item=t,e.from.split("/").slice(1).forEach(e=>a.item=a.item[e])),a.item||(a.item=""),"add"!==e.op&&"remove"!==e.op||("users_dataSources"===o&&(a.item=t.forms.find(e=>e.id===a.item)),["groups_members","forms_entities","users_entities","logicalFrames_entities"].includes(o)&&(a.item=t.entities.find(e=>e.id===a.item)),"forms_elements_partitions_groups_members"===o&&(a.item=a.partition.elements.find(e=>e.id===a.item))),a}patchProject(e){const t=f.cloneDeep(this.project);for(let o=0;o<e;o++)try{u.applyPatch(t,this.revisions[o].backwards)}catch(n){console.log("Error in reverting to datasource at Index ",o),console.log(n)}return t.forms=t.forms.map(e=>new d.a(e)),t}transformDate(e){return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()}}return e.\u0275fac=function(t){return new(t||e)(h.Nb(m.a))},e.\u0275cmp=h.Hb({type:e,selectors:[["app-revision-summary"]],inputs:{revision:"revision",revisions:"revisions",index:"index"},decls:2,vars:1,consts:[[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(h.Tb(0,"ul"),h.Bc(1,v,3,4,"li",0),h.Sb()),2&e&&(h.Bb(1),h.kc("ngForOf",t.output))},directives:[o.k],pipes:[s.c],styles:[""]}),e})();function w(e,t){1&e&&(h.Tb(0,"th",16),h.Dc(1),h.fc(2,"translate"),h.fc(3,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Gc("",h.gc(2,2,"Date")," & ",h.gc(3,4,"User"),""))}function g(e,t){if(1&e&&(h.Tb(0,"td",17),h.Tb(1,"p"),h.Dc(2),h.fc(3,"date"),h.Sb(),h.Tb(4,"p"),h.Dc(5),h.Sb(),h.Sb()),2&e){const e=t.$implicit;h.Bb(2),h.Ec(h.hc(3,2,e.time,"short")),h.Bb(3),h.Ec(e.username)}}function y(e,t){1&e&&(h.Tb(0,"th",16),h.Dc(1),h.fc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Ec(h.gc(2,1,"HistoryChanges")))}function _(e,t){if(1&e&&(h.Tb(0,"td",18),h.Ob(1,"app-revision-summary",19),h.Sb()),2&e){const e=t.$implicit,n=t.dataIndex,o=h.ec();h.Bb(1),h.kc("revision",e)("revisions",o.revisions)("index",n)}}function O(e,t){1&e&&(h.Tb(0,"span"),h.Dc(1),h.fc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Ec(h.gc(2,1,"EquivalentVersion")))}function E(e,t){if(1&e){const e=h.Ub();h.Tb(0,"button",25),h.ac("click",(function(){h.sc(e);const t=h.ec().dataIndex;return h.ec().onRevertClick(t)})),h.Dc(1),h.fc(2,"translate"),h.Sb()}2&e&&(h.Bb(1),h.Ec(h.gc(2,1,"RevertToVersion")))}function P(e,t){1&e&&(h.Tb(0,"div",26),h.Dc(1),h.fc(2,"translate"),h.Sb()),2&e&&(h.Bb(1),h.Ec(h.gc(2,1,"SaveConfirm")))}function C(e,t){if(1&e&&(h.Tb(0,"td",20),h.Tb(1,"div",21),h.Bc(2,O,3,3,"span",22),h.Bc(3,E,3,3,"button",23),h.Sb(),h.Bc(4,P,3,3,"div",24),h.Sb()),2&e){const e=t.$implicit,n=t.dataIndex,o=h.ec();h.Cb("colspan",o.displayedColumns.length),h.Bb(1),h.kc("@detailExpand",e==o.expandedElement?"expanded":"collapsed"),h.Bb(1),h.kc("ngIf",o.sameVersion(n)&&n!==o.saveConfirmElement),h.Bb(1),h.kc("ngIf",!o.sameVersion(n)&&n!==o.saveConfirmElement),h.Bb(1),h.kc("ngIf",n===o.saveConfirmElement)}}function D(e,t){if(1&e){const e=h.Ub();h.Tb(0,"button",25),h.ac("click",(function(){return h.sc(e),h.ec(2).onLoadMore()})),h.Dc(1),h.fc(2,"translate"),h.Sb()}2&e&&(h.Bb(1),h.Ec(h.gc(2,1,"LoadMoreRevisions")))}function x(e,t){if(1&e&&(h.Tb(0,"td",27),h.Bc(1,D,3,3,"button",23),h.Sb()),2&e){const e=h.ec();h.Cb("colspan",e.displayedColumns.length),h.Bb(1),h.kc("ngIf",e.showLoadMore)}}function T(e,t){if(1&e){const e=h.Ub();h.Tb(0,"tr",28),h.ac("mouseover",(function(){return h.sc(e),h.ec().mouseLeave()})),h.Sb()}}function A(e,t){if(1&e){const e=h.Ub();h.Tb(0,"tr",29),h.ac("mouseover",(function(){h.sc(e);const n=t.$implicit;return h.ec().mouseOver(n)})),h.Sb()}if(2&e){const e=t.$implicit,n=h.ec();h.Fb("example-expanded-row",n.expandedElement===e)}}function j(e,t){1&e&&h.Ob(0,"tr",30)}const R=function(e){return{"hidden-row":e}};function I(e,t){if(1&e&&h.Ob(0,"tr",31),2&e){const e=h.ec();h.kc("ngClass",h.oc(1,R,!e.showLoadMore))}}const N=function(){return["expandedDetail"]},L=function(){return["expandedRevisions"]},S=[{path:"",component:(()=>{class e{constructor(e){this.projectService=e,this.displayedColumns=["date","changes"]}ngOnInit(){this.projectService.openedProject.subscribe(e=>{this.showLoadMore=!0,this.projectId=e.id,this.project=e,this.offset=0,this.limit=10,e.id&&this.projectService.listRevisions(e.id,this.limit).then(e=>{this.revisions=e,this.showLoadMore=!(e.length<10)})})}mouseOver(e){this.expandedElement=e}sameVersion(e){const t=this.patchProject(e+1),n=Object(f.isEqual)(t,this.project);return this.isSameVersion=n,n}mouseLeave(){this.expandedElement=null}onLoadMore(){this.limit+=10,this.projectService.listRevisions(this.projectId,this.limit).then(e=>{this.revisions=e,this.showLoadMore=!(e.length<10)})}patchProject(e){const t=this.project.copy();for(let o=0;o<e;o++)try{u.applyPatch(t,this.revisions[o].backwards)}catch(n){console.log("Error in reverting to datasource at Index ",o),console.log(n)}return t.forms=t.forms.map(e=>new d.a(e)),t}expand(e){return this.saveConfirmElement===e}onRevertClick(e){this.saveConfirmElement=e;const t=this.patchProject(e+1);t.forms=t.forms.map(e=>new d.a(e)),this.projectService.project.next(new l.a(t))}}return e.\u0275fac=function(t){return new(t||e)(h.Nb(m.a))},e.\u0275cmp=h.Hb({type:e,selectors:[["app-history"]],decls:21,vars:13,consts:[[1,"info-section","blue"],[1,"mdm-title"],["mat-table","","multiTemplateDataRows","",1,"mdm-table","history-table",3,"dataSource","mouseleave"],["matColumnDef","date"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","id","date",4,"matCellDef"],["matColumnDef","changes"],["mat-cell","","id","changes",4,"matCellDef"],["matColumnDef","expandedDetail"],["mat-cell","",4,"matCellDef"],["matColumnDef","expandedRevisions"],["mat-footer-cell","","class","expand-row",4,"matFooterCellDef"],["mat-header-row","",3,"mouseover",4,"matHeaderRowDef"],["mat-row","","class","example-element-row",3,"example-expanded-row","mouseover",4,"matRowDef","matRowDefColumns"],["mat-row","","class","example-detail-row",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",3,"ngClass",4,"matFooterRowDef"],["mat-header-cell",""],["mat-cell","","id","date"],["mat-cell","","id","changes"],[3,"revision","revisions","index"],["mat-cell",""],[1,"example-element-detail"],[4,"ngIf"],["mat-stroked-button","","class","mdm-button small-button",3,"click",4,"ngIf"],["class","static-row",4,"ngIf"],["mat-stroked-button","",1,"mdm-button","small-button",3,"click"],[1,"static-row"],["mat-footer-cell","",1,"expand-row"],["mat-header-row","",3,"mouseover"],["mat-row","",1,"example-element-row",3,"mouseover"],["mat-row","",1,"example-detail-row"],["mat-footer-row","",3,"ngClass"]],template:function(e,t){1&e&&(h.Tb(0,"div",0),h.Dc(1),h.fc(2,"translate"),h.Sb(),h.Tb(3,"div",1),h.Dc(4),h.fc(5,"translate"),h.Sb(),h.Tb(6,"table",2),h.ac("mouseleave",(function(){return t.mouseLeave()})),h.Rb(7,3),h.Bc(8,w,4,6,"th",4),h.Bc(9,g,6,5,"td",5),h.Qb(),h.Rb(10,6),h.Bc(11,y,3,3,"th",4),h.Bc(12,_,2,3,"td",7),h.Qb(),h.Rb(13,8),h.Bc(14,C,5,5,"td",9),h.Qb(),h.Rb(15,10),h.Bc(16,x,2,2,"td",11),h.Qb(),h.Bc(17,T,1,0,"tr",12),h.Bc(18,A,1,2,"tr",13),h.Bc(19,j,1,0,"tr",14),h.Bc(20,I,1,3,"tr",15),h.Sb()),2&e&&(h.Bb(1),h.Ec(h.gc(2,7,"ProjectHistoryInfo")),h.Bb(3),h.Ec(h.gc(5,9,"History")),h.Bb(2),h.kc("dataSource",t.revisions),h.Bb(11),h.kc("matHeaderRowDef",t.displayedColumns),h.Bb(1),h.kc("matRowDefColumns",t.displayedColumns),h.Bb(1),h.kc("matRowDefColumns",h.nc(11,N)),h.Bb(1),h.kc("matFooterRowDef",h.nc(12,L)))},directives:[i.n,i.c,i.i,i.b,i.e,i.k,i.m,i.g,i.h,i.a,b,o.l,r.a,i.d,i.j,i.l,i.f,o.j],pipes:[s.c,o.e],styles:["#date[_ngcontent-%COMP%]{width:20%}#changes[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:0}.expand-row[_ngcontent-%COMP%]{text-align:center}.hidden-row[_ngcontent-%COMP%]{display:none}tr.example-detail-row[_ngcontent-%COMP%]{height:0}tr.example-element-row[_ngcontent-%COMP%]:not(.example-expanded-row):hover{background:#f5f5f5}tr.example-element-row[_ngcontent-%COMP%]:not(.example-expanded-row):active{background:#efefef}.example-element-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom-width:1px}.example-element-detail[_ngcontent-%COMP%]{overflow:hidden;display:flex;padding:5px;justify-content:center}.mat-column-expandedDetail[_ngcontent-%COMP%]{padding-top:0!important;padding-bottom:0!important}.static-row[_ngcontent-%COMP%]{text-align:center;padding:10px 0 2px}"],data:{animation:[Object(p.n)("detailExpand",[Object(p.k)("collapsed",Object(p.l)({height:"0px",minHeight:"0",padding:"0px"})),Object(p.k)("expanded",Object(p.l)({height:"*"})),Object(p.m)("expanded <=> collapsed",Object(p.e)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}}),e})()}];let k=(()=>{class e{}return e.\u0275mod=h.Lb({type:e}),e.\u0275inj=h.Kb({factory:function(t){return new(t||e)},imports:[[c.f.forChild(S)],c.f]}),e})(),B=(()=>{class e{}return e.\u0275mod=h.Lb({type:e}),e.\u0275inj=h.Kb({factory:function(t){return new(t||e)},imports:[[o.c,s.b]]}),e})(),J=(()=>{class e{}return e.\u0275mod=h.Lb({type:e}),e.\u0275inj=h.Kb({factory:function(t){return new(t||e)},imports:[[o.c,s.b,k,i.p,r.b,a.b,B]]}),e})()}}]);