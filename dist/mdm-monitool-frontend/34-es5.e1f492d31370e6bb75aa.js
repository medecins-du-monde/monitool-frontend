!function(){function t(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function r(t,r){for(var i=0;i<r.length;i++){var e=r[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{ZIQF:function(i,e,n){"use strict";n.r(e),n.d(e,"CrossCuttingModule",(function(){return j}));var o=n("ofXK"),c=n("sYmb"),s=n("3Pt+"),a=n("0IaG"),u=n("kmnG"),d=n("YjUb"),m=n("tyNb"),f=n("QlGT"),l=n("hPXr"),b=n("IPwQ"),p=n("fXoL"),h=n("RTna"),g=n("c3AT"),v=n("XEzf");function y(t,r){if(1&t){var i=p.Ub();p.Rb(0,11),p.Tb(1,"app-extra-indicator",12),p.ac("edit",(function(){p.sc(i);var t=r.$implicit,e=r.index,n=p.ec().index;return p.ec().onEditIndicator(t,e,n)})),p.Sb(),p.Qb()}if(2&t){var e=r.$implicit;p.Bb(1),p.kc("extraIndicator",e.value)("deletable",!1)}}function T(t,r){if(1&t&&(p.Tb(0,"div",5),p.Tb(1,"div",6),p.Dc(2),p.Sb(),p.Tb(3,"div",7),p.Tb(4,"div",8),p.Tb(5,"div",9),p.Bc(6,y,2,2,"ng-container",10),p.Sb(),p.Sb(),p.Sb(),p.Sb()),2&t){var i=r.$implicit,e=r.index,n=p.ec();p.Bb(2),p.Ec(i.value.theme.name.en),p.Bb(1),p.kc("formGroupName",e),p.Bb(3),p.kc("ngForOf",n.getIndicators(e).controls)}}function S(t,r){if(1&t){var i=p.Ub();p.Rb(0,11),p.Tb(1,"app-extra-indicator",12),p.ac("edit",(function(){p.sc(i);var t=r.$implicit,e=r.index;return p.ec(2).onEditIndicator(t,e)})),p.Sb(),p.Qb()}if(2&t){var e=r.$implicit;p.Bb(1),p.kc("extraIndicator",e.value)("deletable",!1)}}function k(t,r){if(1&t&&(p.Tb(0,"div",13),p.Tb(1,"div",5),p.Tb(2,"div",6),p.Dc(3),p.fc(4,"translate"),p.Sb(),p.Tb(5,"div",14),p.Tb(6,"div",9),p.Bc(7,S,2,2,"ng-container",10),p.Sb(),p.Sb(),p.Sb(),p.Sb()),2&t){var i=p.ec();p.Bb(3),p.Ec(p.gc(4,2,"MultipleThematics")),p.Bb(4),p.kc("ngForOf",i.multiThemesArray.controls)}}var I,C,w,A=[{path:"",component:(I=function(){function i(r,e,n,o,c){t(this,i),this.translateService=r,this.indicatorService=e,this.projectService=n,this.dialog=o,this.fb=c,this.indicators=[],this.groups=[],this.multiThemesIndicators=[]}var e,n,o;return e=i,(n=[{key:"getIndicators",value:function(t){return this.crossCuttingForm.controls.groupsArray.get(""+t).get("indicators")}},{key:"ngOnInit",value:function(){var t=this;this.setForm(),this.projectService.openedProject.subscribe((function(r){t.project=r;var i=[];Object.keys(t.project.crossCutting).map((function(r){var e=t.project.crossCutting[r];e.id=r,i.push(e)})),t.indicatorService.listForProject(Object.keys(r.themes).map((function(t){return r.themes[t].id}))).then((function(r){t.indicators=[],t.groups=[],t.multiThemesIndicators=[],r.map((function(r){var e=i.find((function(t){return t.id===r.id}));e&&(e.themes=r.themes,e.display=r.name.en,e.description=r.description,t.indicators.push(new b.d(e)))})),t.indicators.forEach((function(r){if(r.themes.length>1)t.multiThemesIndicators.push(r);else if(r.themes.length>0){var i=t.groups.find((function(t){return t.theme.id===r.themes[0].id}));i?i.indicators.push(r):r.themes.length>0&&t.groups.push({theme:r.themes[0],indicators:[r]})}})),t.setForm()}))}))}},{key:"setForm",value:function(){this.crossCuttingForm=this.fb.group({groupsArray:this.fb.array(this.groups.map((function(t){return l.a.newIndicatorGroup(t)}))),multiThemesArray:this.fb.array(this.multiThemesIndicators.map((function(t){return l.a.newIndicator(t,!0)})))})}},{key:"onEditIndicator",value:function(t,r,i){this.openDialog(l.a.newIndicator(t.value,!0),r,i)}},{key:"openDialog",value:function(t,r,i){var e=this;this.dialog.open(f.a,{data:{indicator:t,forms:this.project.forms}}).afterClosed().subscribe((function(t){t&&(i?e.crossCuttingForm.controls.groupsArray.at(i).get("indicators").setControl(r,t.indicator):e.crossCuttingForm.controls.multiThemesArray.setControl(r,t.indicator),e.project.crossCutting[t.indicator.value.id]=new b.d(t.indicator.value),e.projectService.project.next(e.project))}))}},{key:"groupsArray",get:function(){return this.crossCuttingForm.controls.groupsArray}},{key:"multiThemesArray",get:function(){return this.crossCuttingForm.controls.multiThemesArray}},{key:"currentLang",get:function(){return this.translateService.currentLang?this.translateService.currentLang:this.translateService.defaultLang}}])&&r(e.prototype,n),o&&r(e,o),i}(),I.\u0275fac=function(t){return new(t||I)(p.Nb(c.d),p.Nb(h.a),p.Nb(g.a),p.Nb(a.b),p.Nb(s.f))},I.\u0275cmp=p.Hb({type:I,selectors:[["app-cross-cutting"]],decls:11,vars:9,consts:[[1,"info-section","blue"],[3,"formGroup"],["formArrayName","groupsArray"],["class","mdm-section",4,"ngFor","ngForOf"],["formArrayName","multiThemesArray",4,"ngIf"],[1,"mdm-section"],[1,"mdm-title"],[3,"formGroupName"],["formArrayName","indicators",1,"indicators-list"],[1,"mdm-cards"],["class","mdm-card",4,"ngFor","ngForOf"],[1,"mdm-card"],[1,"mdm-card",3,"extraIndicator","deletable","edit"],["formArrayName","multiThemesArray"],[1,"indicators-list"]],template:function(t,r){1&t&&(p.Tb(0,"div",0),p.Tb(1,"p"),p.Dc(2),p.fc(3,"translate"),p.Sb(),p.Tb(4,"p"),p.Dc(5),p.fc(6,"translate"),p.Sb(),p.Sb(),p.Tb(7,"div",1),p.Tb(8,"div",2),p.Bc(9,T,7,3,"div",3),p.Sb(),p.Bc(10,k,8,4,"div",4),p.Sb()),2&t&&(p.Bb(2),p.Ec(p.gc(3,5,"CrossCuttingInfo.0")),p.Bb(3),p.Ec(p.gc(6,7,"CrossCuttingInfo.1")),p.Bb(2),p.kc("formGroup",r.crossCuttingForm),p.Bb(2),p.kc("ngForOf",r.groupsArray.controls),p.Bb(1),p.kc("ngIf",r.multiThemesArray.length>0))},directives:[s.s,s.k,s.e,o.k,o.l,s.l,v.a],pipes:[c.c],styles:[".indicator-session[_ngcontent-%COMP%]{display:flex;flex-direction:row}"]}),I)}],F=((w=function r(){t(this,r)}).\u0275mod=p.Lb({type:w}),w.\u0275inj=p.Kb({factory:function(t){return new(t||w)},imports:[[m.f.forChild(A)],m.f]}),w),j=((C=function r(){t(this,r)}).\u0275mod=p.Lb({type:C}),C.\u0275inj=p.Kb({factory:function(t){return new(t||C)},imports:[[o.c,c.b,F,a.f,s.m,s.w,u.d,d.a]]}),C)}}])}();